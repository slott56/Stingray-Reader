
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>stingray.schema_instance &#8212; Stingray-Reader 5.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="stingray.cobol_parser" href="stingray.cobol_parser.html" />
    <link rel="prev" title="stingray.estruct" href="stingray.estruct.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="module-stingray.schema_instance">
<span id="stingray-schema-instance"></span><h1>stingray.schema_instance<a class="headerlink" href="#module-stingray.schema_instance" title="Permalink to this headline">¶</a></h1>
<p>schema_instance –  Schema and Navigation models</p>
<p>This module defines a number of foundational
class hierarchies:</p>
<ul class="simple">
<li><p>The <a class="reference internal" href="#stingray.schema_instance.Schema" title="stingray.schema_instance.Schema"><code class="xref py py-class docutils literal notranslate"><span class="pre">Schema</span></code></a> structure.
The concept is to represent any schema
as JSON Schema. From there, <strong>Stingray Reader</strong>
can work with it.
The JSON Schema can be used to provide validation of an instance.</p></li>
<li><p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">Instance</span></code> hierarchy to support
individual “rows” or “records” of a physical
format.
For delimited files (JSON, YAML, TOML, and XML) this is a native object.
For non-delimited files, typified by COBOL, this is a <code class="docutils literal notranslate"><span class="pre">bytes</span></code> or <code class="docutils literal notranslate"><span class="pre">str</span></code>.
For workbook files, this is a <code class="docutils literal notranslate"><span class="pre">list[Any]</span></code>.</p></li>
<li><p>The <a class="reference internal" href="#stingray.schema_instance.Unpacker" title="stingray.schema_instance.Unpacker"><code class="xref py py-class docutils literal notranslate"><span class="pre">Unpacker</span></code></a> hierarchy to support
Unpacking values from bytes, EBCDIC bytes,
strings, navtive Python objects, and workbooks.
In the case of COBOL, the unpacking must be done lazily to properly handle <code class="docutils literal notranslate"><span class="pre">REDEFINES</span></code> and <code class="docutils literal notranslate"><span class="pre">OCCURS</span> <span class="pre">DEPENDING</span> <span class="pre">ON</span></code> features.</p></li>
<li><p>A <a class="reference internal" href="#stingray.schema_instance.Nav" title="stingray.schema_instance.Nav"><code class="xref py py-class docutils literal notranslate"><span class="pre">Nav</span></code></a> hierarchy to handle navigation
through a schema and an instance. This class
allows the <a class="reference internal" href="#stingray.schema_instance.Schema" title="stingray.schema_instance.Schema"><code class="xref py py-class docutils literal notranslate"><span class="pre">Schema</span></code></a> objects to
be essentially immutable and relatively abstract.
All additional details are handled here.</p></li>
<li><p>A <a class="reference internal" href="#stingray.schema_instance.Location" title="stingray.schema_instance.Location"><code class="xref py py-class docutils literal notranslate"><span class="pre">Location</span></code></a> hierarchy specifically
to work with Non-Delimited objects represented
as <code class="docutils literal notranslate"><span class="pre">bytes</span></code> or <code class="docutils literal notranslate"><span class="pre">str</span></code> instances.</p></li>
</ul>
<p>A schema is used to unpack (or decode) the data in a file.
Even a simple CSV file offers headings in the first row as a simplistic schema.</p>
<section id="json-schema">
<h2>JSON Schema<a class="headerlink" href="#json-schema" title="Permalink to this headline">¶</a></h2>
<p>A JSON Schema permits definitions used to navigate spreadsheet files, like CSV.
It is also used to unpack more sophisticated generic structures in JSON, YAML, and TOML format, as well as XML.</p>
<p>A JSON Schema – with some extensions – can be used to unpack COBOL files, in Unicode or ASCII text as well as EBCDIC.
Most of the features of a COBOL DDE definition parallel JSON Schema constructs.</p>
<ul class="simple">
<li><p>COBOL has Atomic fields of type text (with vaious format details), and a variety of “Computational” variants. The
most important is <cite>COMP-3</cite>, which is a decimal representation with digits packed two per byte. The JSON Schema
presumes types “null”, “boolean”, “number”, or “string” types have text representations that fit well with COBOL.</p></li>
<li><p>The hierarchy of COBOL DDE’s is the JSON Schema “object” type.</p></li>
<li><p>The COBOL <code class="docutils literal notranslate"><span class="pre">OCCURS</span></code> clause is the JSON Schema “array” type. The simple case, with a single, literal <cite>TIMES</cite> option
is expressed with <code class="docutils literal notranslate"><span class="pre">maxItems</span></code> and <code class="docutils literal notranslate"><span class="pre">minItems</span></code>.</p></li>
</ul>
<p>While COBOL is more sophisticated than CSV, it’s generally comprarable to JSON/YAML/TOML/XML.
There are some unique specializations related to COBOL processing.</p>
</section>
<section id="cobol-processing">
<h2>COBOL Processing<a class="headerlink" href="#cobol-processing" title="Permalink to this headline">¶</a></h2>
<p>The parallels between COBOL and JSON Schema permit translating COBOL Data Definition Entries (DDE’s) to
JSON Schema constructs.
The JSON Schema (with extensions) is used to decode bytes from COBOL representation to
create native Python objects.</p>
<p>There are three areas of unique complex that require extensions.
The COBOL <code class="docutils literal notranslate"><span class="pre">REDEFINES</span></code> and <code class="docutils literal notranslate"><span class="pre">OCCURS</span> <span class="pre">DEPENDING</span> <span class="pre">ON</span></code> structures.</p>
<p>Additionally, EBCDIC unpacking is handled by <a class="reference internal" href="stingray.estruct.html#module-stingray.estruct" title="stingray.estruct"><code class="xref py py-mod docutils literal notranslate"><span class="pre">stingray.estruct</span></code></a>.</p>
<section id="redefines">
<h3>Redefines<a class="headerlink" href="#redefines" title="Permalink to this headline">¶</a></h3>
<p>A COBOL <code class="docutils literal notranslate"><span class="pre">REDEFINES</span></code> clause defines a free union of types for a given sequence of bytes. Within the application code,
there are generally fields that imply a more useful tagged union. The tags used for discrimination is not part of the
COBOL definition.</p>
<p>To make this work, each field within the JSON schema has an implied starting offset and length.
A COBOL <code class="docutils literal notranslate"><span class="pre">REDEFINES</span></code> clause can be described with a JSON Schema extension that includes a JSON Pointer to name a field with which a given field is co-located.</p>
<p>The COBOL language requires a strict backwards reference to a previously-defined field, and the names must have the
name indentation level, making them peers within the same parent, reducing the need for complex pointers.</p>
</section>
<section id="occurs-depending-on">
<h3>Occurs Depending On<a class="headerlink" href="#occurs-depending-on" title="Permalink to this headline">¶</a></h3>
<p>The complexity of <code class="docutils literal notranslate"><span class="pre">OCCURS</span> <span class="pre">DEPENDING</span> <span class="pre">ON</span></code> constructs arises because the size (<code class="docutils literal notranslate"><span class="pre">maxItems</span></code>) of the array is the value of
another field in the COBOL record definition.</p>
<p>Ideally, a JSON Reference names the referenced field as the <code class="docutils literal notranslate"><span class="pre">maxItems</span></code> attribute for an array. This, however,
is not supported, so an extension vocabulary is required.</p>
</section>
<section id="notes">
<h3>Notes<a class="headerlink" href="#notes" title="Permalink to this headline">¶</a></h3>
<p>See <a class="reference external" href="https://json-schema.org/draft/2020-12/relative-json-pointer.html#RFC6901">https://json-schema.org/draft/2020-12/relative-json-pointer.html#RFC6901</a> for information on JSON Pointers.</p>
</section>
<section id="terminology">
<h3>Terminology<a class="headerlink" href="#terminology" title="Permalink to this headline">¶</a></h3>
<p>The JSON Schema specification talks about the data described by the schema as a “instance” of the schema. The schema
is essentially a class of object, the data is an instance of that class.</p>
<p>It’s awkward to distinguish the more general use of “instance” from the specific use of “Instance of a JSON Schema”.
We’ll try to use <code class="xref py py-class docutils literal notranslate"><span class="pre">Instance</span></code>, and <a class="reference internal" href="#stingray.schema_instance.NDInstance" title="stingray.schema_instance.NDInstance"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDInstance</span></code></a> to talk about the object described by a JSON Schema.</p>
</section>
</section>
<section id="physical-file-formats">
<h2>Physical File Formats<a class="headerlink" href="#physical-file-formats" title="Permalink to this headline">¶</a></h2>
<p>There are several unique considerations
for the various kinds of file formats.
These are implemented via the <a class="reference internal" href="#stingray.schema_instance.Unpacker" title="stingray.schema_instance.Unpacker"><code class="xref py py-class docutils literal notranslate"><span class="pre">Unpacker</span></code></a>
class hierarchy.</p>
<section id="delimited-files">
<h3>Delimited Files<a class="headerlink" href="#delimited-files" title="Permalink to this headline">¶</a></h3>
<p>Delimited files have text representations with syntax defined by a module like <code class="xref py py-mod docutils literal notranslate"><span class="pre">json</span></code>. Because of the presence of delimiters, individual character and byte counting isn’t relevant.</p>
<p>Pythonic navigation through instances of delimited structures leverages the physical format’s parser output. Since most formats provide a mixture of dictionaries and lists, <cite>object[“field”]</cite> and <cite>object[index]</cite> work nicely.</p>
<p>The JSON Schema structure will parallel the instance structure.</p>
</section>
<section id="workbook-files">
<h3>Workbook Files<a class="headerlink" href="#workbook-files" title="Permalink to this headline">¶</a></h3>
<p>Files may also be complex binary objects described by workbook file for XLSX, ODS, Numbers, or CSV files. To an extent, these are somewhat like delimited files, since individual character and byte counting isn’t relevant.</p>
<p>Pythonic navigation through instances of workbook row structures leverages the workbook format’s parser output. Most workbooks are lists of cells; a schema with a flat list of properties will work nicely.</p>
<p>The <code class="xref py py-mod docutils literal notranslate"><span class="pre">csv</span></code> fornmat is built-in. It’s more like a workbook than it is like JSON or TPOML. For example, with simple CSV files, the JSON Schema must be a flat list of properties corresponding to the columns.</p>
</section>
<section id="non-delimited-files-cobol">
<h3>Non-Delimited Files (COBOL)<a class="headerlink" href="#non-delimited-files-cobol" title="Permalink to this headline">¶</a></h3>
<p>It’s essential to provide Pythonic navigation through a COBOL structure. Because of <code class="docutils literal notranslate"><span class="pre">REDEFINES</span></code> clauses, the COBOL structure may not map directly to simple Pythonic dict and list types. Instead, the evaluation of each field must be strictly lazy.</p>
<p>This suggests several target constructs.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">object.name(&quot;field&quot;).value()</span></code> should catapult down through the instance to the named field. Syntactic sugar might include <code class="docutils literal notranslate"><span class="pre">object[&quot;field&quot;]</span></code> or <code class="docutils literal notranslate"><span class="pre">object.field</span></code>. Note that COBOL raises a compile-time error for a reference to an amiguous name; names may be duplicated, but the duplicates must be disambiguated with <code class="docutils literal notranslate"><span class="pre">OF</span></code> clauses.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">object.name(&quot;field&quot;).index(x).value()</span></code> works when the field is a member of an array somewhere above it in the structure. Syntactic sugar might include <code class="docutils literal notranslate"><span class="pre">object[&quot;field&quot;][x]</span></code> or <code class="docutils literal notranslate"><span class="pre">object.field[x]</span></code>.</p></li>
</ul>
<p>These constructs are abbreviations for explicit field-by-field navigation. The field-by-field navigation involves explicitly naming all parent fields. Here are some constructs.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">object.name(&quot;parent&quot;).name(&quot;child&quot;).name(&quot;field&quot;).value()</span></code> is the full navigation path to a nested field. This can be <code class="docutils literal notranslate"><span class="pre">object[&quot;parent&quot;][&quot;child&quot;][&quot;field&quot;]</span></code>. A more sophisticated parser for URL path syntax might also be supported. <code class="docutils literal notranslate"><span class="pre">object.name[&quot;parent/child/field&quot;]</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">object.name(&quot;parent&quot;).name(&quot;child&quot;).index(x).name(&quot;field&quot;).value()</span></code> is the full navigation path to a nesteed field with a parent occurs-depending-on clause. This can be <code class="docutils literal notranslate"><span class="pre">object[&quot;parent&quot;][&quot;child&quot;][x][&quot;field&quot;]</span></code>. A more sophisticated parser for URL path syntax might also be supported. <code class="docutils literal notranslate"><span class="pre">object.name[&quot;parent/child/0/field&quot;]</span></code>.</p></li>
</ul>
<p>The COBOL <code class="docutils literal notranslate"><span class="pre">OF</span></code> construct provides parentage in reverse order. This means <code class="docutils literal notranslate"><span class="pre">object.name(&quot;field&quot;).of(&quot;child&quot;).of(&quot;parent&quot;).value()</span></code> is requred to parallel COBOL syntax. While unpleasant, it’s helpful to support this.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">value()</span></code> method can be helpful to be explicit about locating a value. This avoids eager evaluation of <code class="docutils literal notranslate"><span class="pre">REDEFINES</span></code> alternatives that happen to be invalid.</p>
<p>An alternative to the <code class="docutils literal notranslate"><span class="pre">value()</span></code> method is to use built-in special names <code class="docutils literal notranslate"><span class="pre">__int__()</span></code>, <code class="docutils literal notranslate"><span class="pre">__float__()</span></code>, <code class="docutils literal notranslate"><span class="pre">__str__()</span></code>, <code class="docutils literal notranslate"><span class="pre">__bool__()</span></code> to do conversion to a primitive type; i.e., <code class="docutils literal notranslate"><span class="pre">int(object.name[&quot;parent/child/field&quot;])</span></code>. Additional functions like <code class="docutils literal notranslate"><span class="pre">asdict()</span></code>, <code class="docutils literal notranslate"><span class="pre">aslist()</span></code>, and <code class="docutils literal notranslate"><span class="pre">asdecimal()</span></code> can be provided to handle conversion edge cases.</p>
<p>We show these as multi-step operations with a fluent interface. This works out well when a nagivation context object is associated with each sequence of <code class="docutils literal notranslate"><span class="pre">object.name()...</span></code>, <code class="docutils literal notranslate"><span class="pre">object.index()</span></code>, and <code class="docutils literal notranslate"><span class="pre">object.of()</span></code> operations. The first call in the sequence emits a navigation object; all subsequent steps in the fluent interface return navigation objects. The final <code class="docutils literal notranslate"><span class="pre">value()</span></code> or other special method refers back to the original instance container for type conversion of an atomic field.</p>
<p>Each COBOL navigation step involves two parallel operations:</p>
<ul class="simple">
<li><p>Finding the definition of the named subschema within a JSON schema.</p></li>
<li><p>Locating the sub-instance for the item. This is a slice of the instance.</p></li>
</ul>
<p>The instance is a buffer of bytes (or characters for non-COBOL file processing.) The overall COBOL record has a starting offset of zero. Each DDE has an starting offset and length. For object property navigation this is the offset to the named property that describes the DDE. For array navigation, this is the index to a subinstance within an array of subinstances.</p>
<p>It’s common practice in COBOL to use a non-atomic field as if it was atomic. A date field, for example, may have year, month, and day subfields that are rarely used independently. This means that JSON Schema array and object definitions are implicitly <cite>type: “string”</cite> to parallel the way COBOL treats non-atomic fields as <cite>USAGE IS DISPLAY</cite>.</p>
</section>
</section>
<section id="decimal-places-function">
<h2>decimal_places function<a class="headerlink" href="#decimal-places-function" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="stingray.schema_instance.decimal_places">
<span class="sig-prename descclassname"><span class="pre">stingray.schema_instance.</span></span><span class="sig-name descname"><span class="pre">decimal_places</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">digits</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">decimal.Decimal</span></span></span><a class="headerlink" href="#stingray.schema_instance.decimal_places" title="Permalink to this definition">¶</a></dt>
<dd><p>Quantizes a <code class="xref py py-class docutils literal notranslate"><span class="pre">Decimal</span></code> value to the requested precision.</p>
<p>This undoes mischief to currency values in a workbook.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">decimal_places</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mf">3.99</span><span class="p">)</span>
<span class="go">Decimal(&#39;3.99&#39;)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>digits</strong> – number of digits of precision.</p></li>
<li><p><strong>value</strong> – a numeric value.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a <code class="xref py py-class docutils literal notranslate"><span class="pre">Decimal</span></code> value, quantized to the requested number of decimal places.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="digit-string-function">
<h2>digit_string function<a class="headerlink" href="#digit-string-function" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="stingray.schema_instance.digit_string">
<span class="sig-prename descclassname"><span class="pre">stingray.schema_instance.</span></span><span class="sig-name descname"><span class="pre">digit_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">SupportsInt</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#stingray.schema_instance.digit_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms a numeric value from a spreadsheet into a string with leading zeroes.</p>
<p>This undoes mischief to ZIP codes an SSN’s with leading zeroes in a workbook.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">digit_string</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1020</span><span class="p">)</span>
<span class="go">&#39;01020&#39;</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>size</strong> – target size of the string</p></li>
<li><p><strong>value</strong> – numeric value</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>string with the requested size.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="schema">
<h2>Schema<a class="headerlink" href="#schema" title="Permalink to this headline">¶</a></h2>
<p>Here is the extended JSON Schema definition.
This is a translation of the various JSON Schema constructs into Python class definitions.
These objects must be considered immutable. (Pragmatically, RefTo objects can be updated
to resolve forward references.)</p>
<p>A <a class="reference internal" href="#stingray.schema_instance.Schema" title="stingray.schema_instance.Schema"><code class="xref py py-class docutils literal notranslate"><span class="pre">Schema</span></code></a> is used to describe an <code class="xref py py-class docutils literal notranslate"><span class="pre">Instance</span></code>.
For non-delimited instances, the schema requires additional <a class="reference internal" href="#stingray.schema_instance.Location" title="stingray.schema_instance.Location"><code class="xref py py-class docutils literal notranslate"><span class="pre">Location</span></code></a> information;
this must be computed lazily to permits <code class="docutils literal notranslate"><span class="pre">OCCURS</span> <span class="pre">DEPENDING</span> <span class="pre">ON</span></code> to work.
For delimited instances, no additional data is required, since the parser located all object
boundaries and did conversions to Python types. Similarly, for workbook instances, the
underlying workbook parser can create a row of Python objects.</p>
<p>The <a class="reference internal" href="#stingray.schema_instance.DependsOnArraySchema" title="stingray.schema_instance.DependsOnArraySchema"><code class="xref py py-class docutils literal notranslate"><span class="pre">DependsOnArraySchema</span></code></a> is an extension to handle references to another
field’s value to provide <code class="docutils literal notranslate"><span class="pre">minItems</span></code> and <code class="docutils literal notranslate"><span class="pre">maxItems</span></code> for an array.
This handles the COBOL <code class="docutils literal notranslate"><span class="pre">OCCURS</span> <span class="pre">DEPENDING</span> <span class="pre">ON</span></code>. This requires a reference to another
field which is a reference to another field instead of a simple value.</p>
<p>The COBOL <code class="docutils literal notranslate"><span class="pre">REDEFINES</span></code> clause is handled created a OneOf suite of alternatives
and using some JSON Schema “$ref” references to preserve the original, relatively flat
naming for an elements and the element(s) which redefine it.</p>
<p class="plantuml">
<img src="../../_images/plantuml-41c6c024c5959831486ce48cce52ef235dcfe4da.png" alt="&#64;startuml
    abstract class Schema {
        type: string
    }

    class AtomicSchema

    class ArraySchema

    class DependsOnArraySchema

    class ObjectSchema

    class OneOfSchema

    class RefToSchema

    Schema &lt;|-- AtomicSchema
    Schema &lt;|-- ArraySchema
    Schema &lt;|-- ObjectSchema
    AtomicSchema &lt;|-- OneOfSchema
    AtomicSchema &lt;|-- RefToSchema
    ArraySchema &lt;|-- DependsOnArraySchema
    RefToSchema --&gt; Schema
    'OneOfSchema --&gt; &quot;*&quot; Schema : Redefines
    'ObjectSchema --&gt; &quot;*&quot; Schema : Properties
    'ArraySchema --&gt; Schema : Items
    'DependsOnArraySchema --&gt; Schema : maxItems
&#64;enduml"/>
</p>
<dl class="py class">
<dt class="sig sig-object py" id="stingray.schema_instance.Schema">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">stingray.schema_instance.</span></span><span class="sig-name descname"><span class="pre">Schema</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">attributes</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span> </span><span class="pre">bool</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">typing.Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">typing.Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stingray.schema_instance.Schema" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for Schema definitions.</p>
<p>This wraps a JSONSchema definition,
providing slightly simpler navigation via attribute names
instead of dictionary keys.
<code class="docutils literal notranslate"><span class="pre">s.type</span></code> instead of <code class="docutils literal notranslate"><span class="pre">s['type']</span></code>.</p>
<p>It only works for a few attribute values
in use here. It’s not a general <code class="docutils literal notranslate"><span class="pre">__getattribute__</span></code> wrapper.</p>
<p>Generally, these should be seen as immutable. To permit forward
references, the RefTo subclass needs to be mutated.</p>
<dl class="py property">
<dt class="sig sig-object py" id="stingray.schema_instance.Schema.attributes">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">attributes</span></span><em class="property"><span class="pre">:</span> <span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span> </span><span class="pre">bool</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">typing.Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">typing.Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#stingray.schema_instance.Schema.attributes" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract the dictionary of attribute values.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>dict of keywords from this schema.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.Schema.dump_iter">
<span class="sig-name descname"><span class="pre">dump_iter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nav</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#stingray.schema_instance.Nav" title="stingray.schema_instance.Nav"><span class="pre">stingray.schema_instance.Nav</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indent</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">collections.abc.Iterator</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">'Schema'</span><span class="p"><span class="pre">,</span> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">typing.Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">typing.Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#stingray.schema_instance.Schema.dump_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Navigate into a schema using a <code class="docutils literal notranslate"><span class="pre">Nav</span></code> object to provide unpacker, location and instance context.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nav</strong> – The <a class="reference internal" href="#stingray.schema_instance.Nav" title="stingray.schema_instance.Nav"><code class="xref py py-class docutils literal notranslate"><span class="pre">Nav</span></code></a> helper with unpacker, location, and instance details.</p></li>
<li><p><strong>indent</strong> – Identation for nested display</p></li>
</ul>
</dd>
<dt class="field-even">Yields</dt>
<dd class="field-even"><p>tuple with nesting, schema, indices, and value</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.Schema.json">
<span class="sig-name descname"><span class="pre">json</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span> </span><span class="pre">bool</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">typing.Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">typing.Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#stingray.schema_instance.Schema.json" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the attributes as a JSON structure.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.Schema.print">
<span class="sig-name descname"><span class="pre">print</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indent</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hide</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">set</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#stingray.schema_instance.Schema.print" title="Permalink to this definition">¶</a></dt>
<dd><p>A formatted display of the nested schema.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>indent</strong> – Indentation level</p></li>
<li><p><strong>hide</strong> – Attributes to hide because they’re contained within this as children</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stingray.schema_instance.Schema.type">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">type</span></span><em class="property"><span class="pre">:</span> <span class="pre">str</span></em><a class="headerlink" href="#stingray.schema_instance.Schema.type" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract the type attribute value.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>One of the JSON Schema ‘type’ values.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stingray.schema_instance.ArraySchema">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">stingray.schema_instance.</span></span><span class="sig-name descname"><span class="pre">ArraySchema</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">attributes</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span> </span><span class="pre">bool</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">typing.Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">typing.Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">items</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.Schema" title="stingray.schema_instance.Schema"><span class="pre">stingray.schema_instance.Schema</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stingray.schema_instance.ArraySchema" title="Permalink to this definition">¶</a></dt>
<dd><p>Schema for an array definition.</p>
<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.ArraySchema.dump_iter">
<span class="sig-name descname"><span class="pre">dump_iter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nav</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#stingray.schema_instance.Nav" title="stingray.schema_instance.Nav"><span class="pre">stingray.schema_instance.Nav</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indent</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">collections.abc.Iterator</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">'Schema'</span><span class="p"><span class="pre">,</span> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">typing.Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">typing.Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#stingray.schema_instance.ArraySchema.dump_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Navigate into a schema using a <code class="docutils literal notranslate"><span class="pre">Nav</span></code> object to provide unpacker, location and instance context.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nav</strong> – The <a class="reference internal" href="#stingray.schema_instance.Nav" title="stingray.schema_instance.Nav"><code class="xref py py-class docutils literal notranslate"><span class="pre">Nav</span></code></a> helper with unpacker, location, and instance details.</p></li>
<li><p><strong>indent</strong> – Identation for nested display</p></li>
</ul>
</dd>
<dt class="field-even">Yields</dt>
<dd class="field-even"><p>tuple with nesting, schema, indices, and value</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stingray.schema_instance.ArraySchema.items">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">items</span></span><em class="property"><span class="pre">:</span> <a class="reference internal" href="#stingray.schema_instance.Schema" title="stingray.schema_instance.Schema"><span class="pre">stingray.schema_instance.Schema</span></a></em><a class="headerlink" href="#stingray.schema_instance.ArraySchema.items" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the items sub-schema.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The sub-schema for the items in this array.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stingray.schema_instance.ArraySchema.maxItems">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">maxItems</span></span><em class="property"><span class="pre">:</span> <span class="pre">int</span></em><a class="headerlink" href="#stingray.schema_instance.ArraySchema.maxItems" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a value for maxItems.
For simple arrays, this is the maxItems
value.
The <a class="reference internal" href="#stingray.schema_instance.DependsOnArraySchema" title="stingray.schema_instance.DependsOnArraySchema"><code class="xref py py-class docutils literal notranslate"><span class="pre">DependsOnArraySchema</span></code></a>
subclass will override this.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.ArraySchema.print">
<span class="sig-name descname"><span class="pre">print</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indent</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hide</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">set</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#stingray.schema_instance.ArraySchema.print" title="Permalink to this definition">¶</a></dt>
<dd><p>A formatted display of the nested schema.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>indent</strong> – Indentation level</p></li>
<li><p><strong>hide</strong> – Attributes to hide because they’re contained within this as children</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stingray.schema_instance.AtomicSchema">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">stingray.schema_instance.</span></span><span class="sig-name descname"><span class="pre">AtomicSchema</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">attributes</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span> </span><span class="pre">bool</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">typing.Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">typing.Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stingray.schema_instance.AtomicSchema" title="Permalink to this definition">¶</a></dt>
<dd><p>Schema for an atomic element.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stingray.schema_instance.DependsOnArraySchema">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">stingray.schema_instance.</span></span><span class="sig-name descname"><span class="pre">DependsOnArraySchema</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">attributes</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span> </span><span class="pre">bool</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">typing.Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">typing.Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">items</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.Schema" title="stingray.schema_instance.Schema"><span class="pre">stingray.schema_instance.Schema</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_to</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#stingray.schema_instance.Schema" title="stingray.schema_instance.Schema"><span class="pre">stingray.schema_instance.Schema</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stingray.schema_instance.DependsOnArraySchema" title="Permalink to this definition">¶</a></dt>
<dd><p>Schema for an array with a size that depends on another field.
An extension vocabulary includes a “maxItemsDependsOn” attribute has a reference to another
field in this definition.</p>
<dl class="py property">
<dt class="sig sig-object py" id="stingray.schema_instance.DependsOnArraySchema.maxItems">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">maxItems</span></span><em class="property"><span class="pre">:</span> <span class="pre">int</span></em><a class="headerlink" href="#stingray.schema_instance.DependsOnArraySchema.maxItems" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a value for <code class="docutils literal notranslate"><span class="pre">maxItems</span></code>.
For this class, it’s a type error – there is no <code class="docutils literal notranslate"><span class="pre">maxItems</span></code>
in the schema.
A <a class="reference internal" href="#stingray.schema_instance.Location" title="stingray.schema_instance.Location"><code class="xref py py-class docutils literal notranslate"><span class="pre">Location</span></code></a> object will have size information,</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stingray.schema_instance.ObjectSchema">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">stingray.schema_instance.</span></span><span class="sig-name descname"><span class="pre">ObjectSchema</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">attributes</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span> </span><span class="pre">bool</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">typing.Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">typing.Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">properties</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">'Schema'</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stingray.schema_instance.ObjectSchema" title="Permalink to this definition">¶</a></dt>
<dd><p>Schema for an object with properties.</p>
<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.ObjectSchema.dump_iter">
<span class="sig-name descname"><span class="pre">dump_iter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nav</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#stingray.schema_instance.Nav" title="stingray.schema_instance.Nav"><span class="pre">stingray.schema_instance.Nav</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indent</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">collections.abc.Iterator</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">'Schema'</span><span class="p"><span class="pre">,</span> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">typing.Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">typing.Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#stingray.schema_instance.ObjectSchema.dump_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Navigate into a schema using a <code class="docutils literal notranslate"><span class="pre">Nav</span></code> object to provide unpacker, location and instance context.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nav</strong> – The <a class="reference internal" href="#stingray.schema_instance.Nav" title="stingray.schema_instance.Nav"><code class="xref py py-class docutils literal notranslate"><span class="pre">Nav</span></code></a> helper with unpacker, location, and instance details.</p></li>
<li><p><strong>indent</strong> – Identation for nested display</p></li>
</ul>
</dd>
<dt class="field-even">Yields</dt>
<dd class="field-even"><p>tuple with nesting, schema, indices, and value</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.ObjectSchema.print">
<span class="sig-name descname"><span class="pre">print</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indent</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hide</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">set</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#stingray.schema_instance.ObjectSchema.print" title="Permalink to this definition">¶</a></dt>
<dd><p>A formatted display of the nested schema.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>indent</strong> – Indentation level</p></li>
<li><p><strong>hide</strong> – Attributes to hide because they’re contained within this as children</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stingray.schema_instance.OneOfSchema">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">stingray.schema_instance.</span></span><span class="sig-name descname"><span class="pre">OneOfSchema</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">attributes</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span> </span><span class="pre">bool</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">typing.Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">typing.Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alternatives</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">'Schema'</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stingray.schema_instance.OneOfSchema" title="Permalink to this definition">¶</a></dt>
<dd><p>Schema for a “oneOf” definition.
This is the basis for COBOL <code class="docutils literal notranslate"><span class="pre">REDEFINES</span></code>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.OneOfSchema.dump_iter">
<span class="sig-name descname"><span class="pre">dump_iter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nav</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#stingray.schema_instance.Nav" title="stingray.schema_instance.Nav"><span class="pre">stingray.schema_instance.Nav</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indent</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">collections.abc.Iterator</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">'Schema'</span><span class="p"><span class="pre">,</span> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">typing.Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">typing.Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#stingray.schema_instance.OneOfSchema.dump_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Navigate into a schema using a <code class="docutils literal notranslate"><span class="pre">Nav</span></code> object to provide unpacker, location and instance context.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nav</strong> – The <a class="reference internal" href="#stingray.schema_instance.Nav" title="stingray.schema_instance.Nav"><code class="xref py py-class docutils literal notranslate"><span class="pre">Nav</span></code></a> helper with unpacker, location, and instance details.</p></li>
<li><p><strong>indent</strong> – Identation for nested display</p></li>
</ul>
</dd>
<dt class="field-even">Yields</dt>
<dd class="field-even"><p>tuple with nesting, schema, indices, and value</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.OneOfSchema.print">
<span class="sig-name descname"><span class="pre">print</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indent</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hide</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">set</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#stingray.schema_instance.OneOfSchema.print" title="Permalink to this definition">¶</a></dt>
<dd><p>A formatted display of the nested schema.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>indent</strong> – Indentation level</p></li>
<li><p><strong>hide</strong> – Attributes to hide because they’re contained within this as children</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stingray.schema_instance.OneOfSchema.type">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">type</span></span><em class="property"><span class="pre">:</span> <span class="pre">str</span></em><a class="headerlink" href="#stingray.schema_instance.OneOfSchema.type" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an imputed type of “oneOf”.
The actual JSON Schema doesn’t use
the “type” keyword for these.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Literal[“oneOf”]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stingray.schema_instance.RefToSchema">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">stingray.schema_instance.</span></span><span class="sig-name descname"><span class="pre">RefToSchema</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">attributes</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span> </span><span class="pre">bool</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">typing.Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">typing.Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_to</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#stingray.schema_instance.Schema" title="stingray.schema_instance.Schema"><span class="pre">stingray.schema_instance.Schema</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stingray.schema_instance.RefToSchema" title="Permalink to this definition">¶</a></dt>
<dd><p>Must deference type and attributes properties.</p>
<dl class="py property">
<dt class="sig sig-object py" id="stingray.schema_instance.RefToSchema.attributes">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">attributes</span></span><em class="property"><span class="pre">:</span> <span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span> </span><span class="pre">bool</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">typing.Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">typing.Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#stingray.schema_instance.RefToSchema.attributes" title="Permalink to this definition">¶</a></dt>
<dd><p>Deference the anchor name and return the attributes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.RefToSchema.dump_iter">
<span class="sig-name descname"><span class="pre">dump_iter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nav</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#stingray.schema_instance.Nav" title="stingray.schema_instance.Nav"><span class="pre">stingray.schema_instance.Nav</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indent</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">collections.abc.Iterator</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">'Schema'</span><span class="p"><span class="pre">,</span> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">typing.Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">typing.Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#stingray.schema_instance.RefToSchema.dump_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Navigate into a schema using a <code class="docutils literal notranslate"><span class="pre">Nav</span></code> object to provide unpacker, location and instance context.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nav</strong> – The <a class="reference internal" href="#stingray.schema_instance.Nav" title="stingray.schema_instance.Nav"><code class="xref py py-class docutils literal notranslate"><span class="pre">Nav</span></code></a> helper with unpacker, location, and instance details.</p></li>
<li><p><strong>indent</strong> – Identation for nested display</p></li>
</ul>
</dd>
<dt class="field-even">Yields</dt>
<dd class="field-even"><p>tuple with nesting, schema, indices, and value</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stingray.schema_instance.RefToSchema.items">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">items</span></span><em class="property"><span class="pre">:</span> <a class="reference internal" href="#stingray.schema_instance.Schema" title="stingray.schema_instance.Schema"><span class="pre">stingray.schema_instance.Schema</span></a></em><a class="headerlink" href="#stingray.schema_instance.RefToSchema.items" title="Permalink to this definition">¶</a></dt>
<dd><p>Deference the anchor name and return items.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stingray.schema_instance.RefToSchema.properties">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">properties</span></span><em class="property"><span class="pre">:</span> <span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">'Schema'</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#stingray.schema_instance.RefToSchema.properties" title="Permalink to this definition">¶</a></dt>
<dd><p>Deference the anchor name and return properties.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stingray.schema_instance.RefToSchema.type">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">type</span></span><em class="property"><span class="pre">:</span> <span class="pre">str</span></em><a class="headerlink" href="#stingray.schema_instance.RefToSchema.type" title="Permalink to this definition">¶</a></dt>
<dd><p>Deference the anchor name and return the type.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stingray.schema_instance.SchemaMaker">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">stingray.schema_instance.</span></span><span class="sig-name descname"><span class="pre">SchemaMaker</span></span><a class="headerlink" href="#stingray.schema_instance.SchemaMaker" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a <a class="reference internal" href="#stingray.schema_instance.Schema" title="stingray.schema_instance.Schema"><code class="xref py py-class docutils literal notranslate"><span class="pre">Schema</span></code></a> structure from a JSON Schema document.</p>
<p>This doesn’t do much, but it allows us to use classes to define methods 
that apply to the JSON Schema constructs instead of referring to them 
as the source document dictionaries.</p>
<p>This relies on an <code class="docutils literal notranslate"><span class="pre">maxItemsDependsOn</span></code> extension vocabulary to describe <code class="docutils literal notranslate"><span class="pre">OCCURS</span> <span class="pre">DEPENDING</span> <span class="pre">ON</span></code>.</p>
<p>All <code class="docutils literal notranslate"><span class="pre">$ref</span></code> names are expected to refer to explicit <code class="docutils literal notranslate"><span class="pre">$anchor</span></code> names within this schema.
Since anchor names may occur at the end, in a <code class="docutils literal notranslate"><span class="pre">#def</span></code> section,
we defer the forward references and tweak the schema objects.</p>
<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.SchemaMaker.from_json">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">from_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span> </span><span class="pre">bool</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">typing.Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">typing.Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#stingray.schema_instance.Schema" title="stingray.schema_instance.Schema"><span class="pre">stingray.schema_instance.Schema</span></a></span></span><a class="headerlink" href="#stingray.schema_instance.SchemaMaker.from_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a <a class="reference internal" href="#stingray.schema_instance.Schema" title="stingray.schema_instance.Schema"><code class="xref py py-class docutils literal notranslate"><span class="pre">Schema</span></code></a> from a JSONSchema document.
This walks the hierarchy and resolves the <code class="docutils literal notranslate"><span class="pre">$ref</span></code> references.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>source</strong> – A JSONSchema document.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <a class="reference internal" href="#stingray.schema_instance.Schema" title="stingray.schema_instance.Schema"><code class="xref py py-class docutils literal notranslate"><span class="pre">Schema</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.SchemaMaker.resolve">
<span class="sig-name descname"><span class="pre">resolve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">schema</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.Schema" title="stingray.schema_instance.Schema"><span class="pre">stingray.schema_instance.Schema</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#stingray.schema_instance.Schema" title="stingray.schema_instance.Schema"><span class="pre">stingray.schema_instance.Schema</span></a></span></span><a class="headerlink" href="#stingray.schema_instance.SchemaMaker.resolve" title="Permalink to this definition">¶</a></dt>
<dd><p>Resolve forward <code class="docutils literal notranslate"><span class="pre">$ref</span></code> references.</p>
<p>This is not invoked directly, it’s used by the <a class="reference internal" href="#stingray.schema_instance.SchemaMaker.from_json" title="stingray.schema_instance.SchemaMaker.from_json"><code class="xref py py-meth docutils literal notranslate"><span class="pre">from_json()</span></code></a> method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>schema</strong> – A <code class="docutils literal notranslate"><span class="pre">Schema</span></code> document that requires fixup
Generally, this <strong>must</strong> be the schema created by <code class="xref py py-meth docutils literal notranslate"><span class="pre">walk()</span></code>.
This <a class="reference internal" href="#stingray.schema_instance.SchemaMaker" title="stingray.schema_instance.SchemaMaker"><code class="xref py py-class docutils literal notranslate"><span class="pre">SchemaMaker</span></code></a> instance has a cache of <code class="docutils literal notranslate"><span class="pre">$anchor</span></code> names
used for resolution.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <code class="docutils literal notranslate"><span class="pre">Schema</span></code> document after fixing references.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.SchemaMaker.walk_schema">
<span class="sig-name descname"><span class="pre">walk_schema</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span> </span><span class="pre">bool</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">typing.Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">typing.Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">()</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#stingray.schema_instance.Schema" title="stingray.schema_instance.Schema"><span class="pre">stingray.schema_instance.Schema</span></a></span></span><a class="headerlink" href="#stingray.schema_instance.SchemaMaker.walk_schema" title="Permalink to this definition">¶</a></dt>
<dd><p>Recursive walk of a JSON Schema document, create <a class="reference internal" href="#stingray.schema_instance.Schema" title="stingray.schema_instance.Schema"><code class="xref py py-class docutils literal notranslate"><span class="pre">Schema</span></code></a> objects
for each schema and all of the children sub-schema.</p>
<p>This is not invoked directly. It’s used by the <a class="reference internal" href="#stingray.schema_instance.SchemaMaker.from_json" title="stingray.schema_instance.SchemaMaker.from_json"><code class="xref py py-meth docutils literal notranslate"><span class="pre">from_json()</span></code></a> method.</p>
<p>Relies on an <code class="docutils literal notranslate"><span class="pre">maxItemsDependsOn</span></code> extension to describe <code class="docutils literal notranslate"><span class="pre">OCCURS</span> <span class="pre">DEPENDING</span> <span class="pre">ON</span></code>.</p>
<p>Builds an anchor name cache to resolve “$ref” after an
initial construction pass.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source</strong> – A valid JSONSchema document.</p></li>
<li><p><strong>path</strong> – The Path to a given property. This starts as an empty tuple. Names are added as properties are processed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <a class="reference internal" href="#stingray.schema_instance.Schema" title="stingray.schema_instance.Schema"><code class="xref py py-class docutils literal notranslate"><span class="pre">Schema</span></code></a> object.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stingray.schema_instance.Reference">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">stingray.schema_instance.</span></span><span class="sig-name descname"><span class="pre">Reference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stingray.schema_instance.Reference" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="instance">
<h2>Instance<a class="headerlink" href="#instance" title="Permalink to this headline">¶</a></h2>
<p>For bytes and strings, we provide wrapper <code class="xref py py-class docutils literal notranslate"><span class="pre">Instance</span></code> definitions.
These <a class="reference internal" href="#stingray.schema_instance.BytesInstance" title="stingray.schema_instance.BytesInstance"><code class="xref py py-class docutils literal notranslate"><span class="pre">BytesInstance</span></code></a> and <a class="reference internal" href="#stingray.schema_instance.TextInstance" title="stingray.schema_instance.TextInstance"><code class="xref py py-class docutils literal notranslate"><span class="pre">TextInstance</span></code></a>
are used by <a class="reference internal" href="#stingray.schema_instance.NDNav" title="stingray.schema_instance.NDNav"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDNav</span></code></a> and <a class="reference internal" href="#stingray.schema_instance.Location" title="stingray.schema_instance.Location"><code class="xref py py-class docutils literal notranslate"><span class="pre">Location</span></code></a> objects.</p>
<p>For <a class="reference internal" href="#stingray.schema_instance.DInstance" title="stingray.schema_instance.DInstance"><code class="xref py py-class docutils literal notranslate"><span class="pre">DInstance</span></code></a> and <a class="reference internal" href="#stingray.schema_instance.WBInstance" title="stingray.schema_instance.WBInstance"><code class="xref py py-class docutils literal notranslate"><span class="pre">WBInstance</span></code></a>, however, we don’t
really need any additional features. We can use native <code class="docutils literal notranslate"><span class="pre">JSON</span></code> or <code class="docutils literal notranslate"><span class="pre">list[Any]</span></code>
objects.</p>
<dl class="py class">
<dt class="sig sig-object py" id="stingray.schema_instance.WBInstance">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">stingray.schema_instance.</span></span><span class="sig-name descname"><span class="pre">WBInstance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stingray.schema_instance.WBInstance" title="Permalink to this definition">¶</a></dt>
<dd><p>CSV files are <code class="docutils literal notranslate"><span class="pre">list[str]</span></code>. All other workbooks tend to be  <code class="docutils literal notranslate"><span class="pre">list[Any]</span></code>
because their unpacker modules do conversions.</p>
<p>We’ll tolerate any sequence type.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stingray.schema_instance.DInstance">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">stingray.schema_instance.</span></span><span class="sig-name descname"><span class="pre">DInstance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stingray.schema_instance.DInstance" title="Permalink to this definition">¶</a></dt>
<dd><p>JSON/YAML/TOML documents are wild and free.
Pragmatically, we want o supplement these classes with methods
that emit <code class="docutils literal notranslate"><span class="pre">DNav</span></code> objects to manage navigating an object and a schema in parallel.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stingray.schema_instance.NDInstance">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">stingray.schema_instance.</span></span><span class="sig-name descname"><span class="pre">NDInstance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stingray.schema_instance.NDInstance" title="Permalink to this definition">¶</a></dt>
<dd><p>The essential features of a non-delimited instance.
The underlying data is <code class="docutils literal notranslate"><span class="pre">AnyStr</span></code>, either bytes or text.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stingray.schema_instance.BytesInstance">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">stingray.schema_instance.</span></span><span class="sig-name descname"><span class="pre">BytesInstance</span></span><a class="headerlink" href="#stingray.schema_instance.BytesInstance" title="Permalink to this definition">¶</a></dt>
<dd><p>Fulfills the protocol for an <code class="docutils literal notranslate"><span class="pre">NDInstance</span></code>, useful for <code class="docutils literal notranslate"><span class="pre">EBCDIC</span></code> and <code class="docutils literal notranslate"><span class="pre">StructUnpacker</span></code>
Unpackers.</p>
<p>To create an <a class="reference internal" href="#stingray.schema_instance.NDNav" title="stingray.schema_instance.NDNav"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDNav</span></code></a>, this object requires two things:
- A <cite>Schema</cite> used to create <cite>Location</cite> objects.
- An <cite>NonDelimited</cite> subclass of <cite>Unpacker</cite> to provide physical format details like size and unpacking.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">schema</span> <span class="o">=</span> <span class="n">SchemaMaker</span><span class="o">.</span><span class="n">from_json</span><span class="p">({</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span> <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;field-1&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;cobol&quot;</span><span class="p">:</span> <span class="s2">&quot;PIC X(12)&quot;</span><span class="p">}}})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unpacker</span> <span class="o">=</span> <span class="n">EBCDIC</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">BytesInstance</span><span class="p">(</span><span class="s1">&#39;blahblahblah&#39;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;CP037&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unpacker</span><span class="o">.</span><span class="n">nav</span><span class="p">(</span><span class="n">schema</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="s2">&quot;field-1&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
<span class="go">&#39;blahblahblah&#39;</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">Sheet.row_iter()</span></code> build <code class="docutils literal notranslate"><span class="pre">Row</span></code> objects that wrap an unpacker, schema, and instance.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stingray.schema_instance.TextInstance">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">stingray.schema_instance.</span></span><span class="sig-name descname"><span class="pre">TextInstance</span></span><a class="headerlink" href="#stingray.schema_instance.TextInstance" title="Permalink to this definition">¶</a></dt>
<dd><p>Fulfills the protocol for an <code class="docutils literal notranslate"><span class="pre">NDInstance</span></code>. Useful for <code class="docutils literal notranslate"><span class="pre">TextUnpacker</span></code>.</p>
<p>To create an <a class="reference internal" href="#stingray.schema_instance.NDNav" title="stingray.schema_instance.NDNav"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDNav</span></code></a>, this object requires two things:
- A <cite>Schema</cite> which populates the <cite>Location</cite> objects.
- An <cite>NonDelimited</cite> subclass of <cite>Unpacker</cite> to provide physical format details like size and unpacking.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">schema</span> <span class="o">=</span> <span class="n">SchemaMaker</span><span class="o">.</span><span class="n">from_json</span><span class="p">({</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span> <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;field-1&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;cobol&quot;</span><span class="p">:</span> <span class="s2">&quot;PIC X(12)&quot;</span><span class="p">}}})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unpacker</span> <span class="o">=</span> <span class="n">TextUnpacker</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">TextInstance</span><span class="p">(</span><span class="s1">&#39;blahblahblah&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unpacker</span><span class="o">.</span><span class="n">nav</span><span class="p">(</span><span class="n">schema</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="s2">&quot;field-1&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
<span class="go">&#39;blahblahblah&#39;</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">Sheet.row_iter()</span></code> build <code class="docutils literal notranslate"><span class="pre">Row</span></code> objects that wrap an unpacker, schema, and instance.</p>
</dd></dl>

</section>
<section id="unpacker">
<h2>Unpacker<a class="headerlink" href="#unpacker" title="Permalink to this headline">¶</a></h2>
<p>An <cite>Unpacker</cite> is a strategy class that handles details of physical unpacking of bytes or text. We call it an <cite>Unpacker</cite>, because it’s similar to <cite>struct.unpack</cite>.</p>
<p>The JSON Schema’s intent is to depend on delimited files, using a separate parser. For this application, however, the schema is used to provide information to the parser.</p>
<p>To work with the variety of instance data, we have several subclasses of <cite>Instance</cite> and related <cite>Unpacker</cite> classes:</p>
<ul>
<li><p><strong>Non-Delimited</strong>. These cases use <cite>Location</cite> objects. We define an <code class="docutils literal notranslate"><span class="pre">NDInstance</span></code> as a common protocol
wrapped around <code class="docutils literal notranslate"><span class="pre">AnyStr</span></code> types. There are three sub-cases depending on the underlying object.</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>COBOL Bytes</strong>. An <cite>NDInstance</cite> type union includes <cite>bytes</cite>. The <cite>estruct</cite> module is a COBOL replacement for the <cite>struct</cite> module. The JSON Schema requires extensions to handle COBOL complexities.</p></li>
<li><p><strong>STRUCT Bytes</strong>. An <cite>NDInstance</cite> type union includes <cite>bytes</cite>. The <cite>struct</cite> module <cite>unpack</cite> and <cite>calcsize</cite> are used directly. This means the field codes must match the <cite>struct</cite> module’s definitions. This can leverage some of the same extensions as COBOL requires.</p></li>
<li><p><strong>Text</strong>. An <cite>NDInstance</cite> type union includes <cite>str</cite>. This is the case with non-delimited text that has plain text encodings for data. The DISPLAY data will be ASCII or UTF-8, and any COMP/BINARY numbers are represented as text.</p></li>
</ul>
</div></blockquote>
</li>
<li><p><strong>Delimited</strong>. These cases do not use <cite>Location</cite> objects. There are two sub-cases:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>JSON Objects</strong>. This is a Union of <code class="docutils literal notranslate"><span class="pre">dict[str,</span> <span class="pre">Any]</span> <span class="pre">|</span> <span class="pre">Any</span> <span class="pre">|</span> <span class="pre">list[Any]</span></code>.
The instance is created by some external unpacker, and is already in a Python native structure.
Unpackers include <code class="docutils literal notranslate"><span class="pre">json</span></code>, <code class="docutils literal notranslate"><span class="pre">toml</span></code>, and <code class="docutils literal notranslate"><span class="pre">yaml</span></code>. A wrapper around an <code class="docutils literal notranslate"><span class="pre">xml</span></code> parser
can be used, also.
We’ll use a <code class="docutils literal notranslate"><span class="pre">JSON</span></code> type hint for objects this unpacker works with.</p></li>
<li><p><strong>Workbook Rows</strong>. These include CSV, ODS, XLSX, and Numbers documents.
The instance is a structure created by the workbook module as an unpacker.
The <code class="xref py py-mod docutils literal notranslate"><span class="pre">csv</span></code> unpacker is built-in.
These all use <code class="docutils literal notranslate"><span class="pre">list[Any]</span></code> for objects this unpacker works with.</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<p>Unpacking is a plug-in strategy.
For non-delimited data, it combines some essential location information with a <cite>value()</cite> method that’s unique to the instance source data.
For delimited data, it provides a uniforma interface for the various kinds of spreadsheets.</p>
<p>The JSON Schema extensions to drive unpacking include the <cite>“cobol”</cite> keyword. The value for this has the original COBOL DDE. This definition can have  USAGE and  PICTURE clauses that define how bytes will encode the value.</p>
<p class="plantuml">
<img src="../../_images/plantuml-5fb8731dc9b4e9eac38fdeecbb5c14d5d6cffdc9.png" alt="&#64;startuml
    abstract class Unpacker {
        calcsize(schema): int
        value(schema, instance): Any
        nav(schema, instance): Nav
    }

    class Location

    abstract class Nav

    abstract class Schema

    Unpacker &quot;n&quot; -- Schema
    Unpacker --&gt; Location : creates
    Unpacker --&gt; Nav : creates

    abstract class NonDelimited
    Unpacker &lt;|-- NonDelimited

    class EBCDIC
    NonDelimited &lt;|-- EBCDIC

    class Struct
    NonDelimited &lt;|-- Struct

    class Text
    NonDelimited &lt;|-- Text

    class Delimited
    Unpacker &lt;|-- Delimited

    class Sequence
    Delimited &lt;|-- Sequence

    class Mapping
    Delimited &lt;|-- Mapping

&#64;enduml"/>
</p>
<section id="implementation-notes">
<h3>Implementation Notes<a class="headerlink" href="#implementation-notes" title="Permalink to this headline">¶</a></h3>
<p>We need three separate kinds of <code class="docutils literal notranslate"><span class="pre">Unpacker</span></code> subclasses to manage the kinds of <code class="docutils literal notranslate"><span class="pre">Instance</span></code> subclasses:</p>
<ul class="simple">
<li><p>The <cite>NonDelimited</cite> subclass of <cite>Unpacker</cite> handles an <cite>NDInstance</cite>
which is either a string or bytes with non-delimited data.
The <cite>Location</cite> reflects an offset into the <cite>NDInstance</cite>.</p></li>
<li><p>The <cite>Delimited</cite> subclass of <cite>Unpacker</cite> handles delimited data, generally using <code class="docutils literal notranslate"><span class="pre">JSON</span></code>
as a type hint. This will have a <cite>dict[str, Any] | list[Any] | Any</cite> structure.</p></li>
<li><p>A <cite>Workbook</cite> subclass of <cite>Unpacker</cite> wraps a workbook parser creating a <code class="docutils literal notranslate"><span class="pre">WBInstance</span></code>.
Generally workbook rows are <cite>list[Any]</cite> structures.</p></li>
</ul>
<p>An <code class="docutils literal notranslate"><span class="pre">Unpacker</span></code> instance is a factory for <code class="docutils literal notranslate"><span class="pre">Nav</span></code> objects. When we need to navigate around
an instance, we’ll leverage <code class="docutils literal notranslate"><span class="pre">unpacker.nav(schema,</span> <span class="pre">instance)</span></code>. Since the
schema binding doesn’t change very often, <code class="docutils literal notranslate"><span class="pre">nav</span> <span class="pre">=</span> <span class="pre">partial(unpacker.nav,</span> <span class="pre">(schema,))</span></code> is
a helpful simplification. With this partial, <code class="docutils literal notranslate"><span class="pre">nav(instance).name(n)</span></code> or <code class="docutils literal notranslate"><span class="pre">nav(instance).index(n)</span></code> are all that’s needed
to locate a named field or apply array indices.</p>
</section>
<section id="unpacker-size-computations">
<h3>Unpacker Size Computations<a class="headerlink" href="#unpacker-size-computations" title="Permalink to this headline">¶</a></h3>
<p>The sizes are <em>highly</em> dependent on format information that comes from COBOL DDE (or other schema details.) A <cite>cobol</cite> extension to JSON Schema provides the COBOL-syntax <cite>USAGE</cite> and <cite>PICTURE</cite> clauses required to parse bytes. There are four overall cases, only two of which require careful size computations.</p>
<p><strong>Non-Delimited COBOL</strong>.  See <a class="reference external" href="https://www.ibm.com/docs/en/cobol-zos/4.2?topic=clause-computational-items">https://www.ibm.com/docs/en/cobol-zos/4.2?topic=clause-computational-items</a> and <a class="reference external" href="https://www.ibm.com/docs/en/cobol-zos/4.2?topic=entry-usage-clause">https://www.ibm.com/docs/en/cobol-zos/4.2?topic=entry-usage-clause</a> and <a class="reference external" href="https://www.ibm.com/docs/en/cobol-zos/4.2?topic=entry-picture-clause">https://www.ibm.com/docs/en/cobol-zos/4.2?topic=entry-picture-clause</a>.</p>
<ul class="simple">
<li><p><cite>USAGE DISPLAY</cite>. <cite>PIC X…</cite> or <cite>PIC A…</cite>. Data is text. Size given by the picture. Value is <cite>str</cite>.</p></li>
<li><p><cite>USAGE DISPLAY</cite>. <cite>PIC 9…</cite>. Data is “Zoned Decimal” text. Size given by the picture. Value is <cite>decimal</cite>.</p></li>
<li><p><cite>USAGE COMP</cite> or <cite>USAGE BINARY</cite> or <cite>USAGE COMP-4</cite>. <cite>PIC 9…</cite>. Data is bytes. Size based on the picture: 1-4 digits is two bytes. 5-9 digits is 4 bytes. 10-18 is 8 bytes. Value is a <cite>int</cite>.</p></li>
<li><p><cite>USAGE COMP-1</cite>. <cite>PIC 9…</cite>. Data is 32-bit float. Size is 4. Value is <cite>float</cite>.</p></li>
<li><p><cite>USAGE COMP-2</cite>. <cite>PIC 9…</cite>. Data is 64-bit float. Size is 8. Value is <cite>float</cite>.</p></li>
<li><p><cite>USAGE COMP-3</cite> or <cite>USAGE PACKED-DECIMAL</cite>. <cite>PIC 9…</cite>. Data is two-digits-per-byte packed decimal. Value is a <cite>decimal</cite>.</p></li>
</ul>
<p><strong>Non-Delimited Native</strong>. Follows the Python <cite>struct</cite> module definitions. The <cite>struct.calcsize()</cite> function computes the structure’s size. <cite>struct.unpack()</cite> unpacks the values using the format specification. Or <cite>maxLength</cite> can be used to define sizes.</p>
<p><strong>Delimited</strong>. The underlying parser (JSON, YAML, TOML, XML) decomposed the data and performed conversions. The schema conversions <em>should</em> match the data that’s present</p>
<p><strong>Workbook</strong>. Generally, an underlying workbook unpacker is required. For CSV, the data is all strings, conversions are defined only in the schema.</p>
</section>
<section id="conversions">
<h3>Conversions<a class="headerlink" href="#conversions" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">CONVERSION</span></code> mapping has values for the “conversion” keyword.
Some of these are extensions that could also be part of a vocabulary for COBOL and Workbooks.</p>
<p>Date, Time, Timestamp, Duration, and Error may need to be part of these conversions.
The problem with non-ISO standard dates means that a package like <code class="docutils literal notranslate"><span class="pre">dateutil</span></code> is required
to guess at the format.</p>
<p>For US ZIP codes, a <code class="docutils literal notranslate"><span class="pre">digit_string(size,</span> <span class="pre">value)</span></code> function turns an integer to a string padded with zeroes.
The partial function <code class="docutils literal notranslate"><span class="pre">digits_5</span> <span class="pre">=</span> <span class="pre">partial(digit_string,</span> <span class="pre">5)</span></code> is used to transforms spreadsheet zip
codes from integers back into useful strings.</p>
<p>For currency in many countries, a <code class="docutils literal notranslate"><span class="pre">decimal_places()</span></code> function will transform a float value back to Decimal
with an appropriate number of decimal places. The partial function <code class="docutils literal notranslate"><span class="pre">decimal_2</span> <span class="pre">=</span> <span class="pre">partial(decimal_places,</span> <span class="pre">2)</span></code>
will transform float dollars into a decimal value rounded to the nearest penny</p>
<dl class="py class">
<dt class="sig sig-object py" id="stingray.schema_instance.Mode">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">stingray.schema_instance.</span></span><span class="sig-name descname"><span class="pre">Mode</span></span><a class="headerlink" href="#stingray.schema_instance.Mode" title="Permalink to this definition">¶</a></dt>
<dd><p>Two handy constants used to by Unpackers to open files.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="stingray.schema_instance.Mode.BINARY">
<span class="sig-name descname"><span class="pre">BINARY</span></span><em class="property"> <span class="pre">=</span> <span class="pre">'rb'</span></em><a class="headerlink" href="#stingray.schema_instance.Mode.BINARY" title="Permalink to this definition">¶</a></dt>
<dd><p>Binary mode file open</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stingray.schema_instance.Mode.TEXT">
<span class="sig-name descname"><span class="pre">TEXT</span></span><em class="property"> <span class="pre">=</span> <span class="pre">'r'</span></em><a class="headerlink" href="#stingray.schema_instance.Mode.TEXT" title="Permalink to this definition">¶</a></dt>
<dd><p>Text mode file open</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stingray.schema_instance.Unpacker">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">stingray.schema_instance.</span></span><span class="sig-name descname"><span class="pre">Unpacker</span></span><a class="headerlink" href="#stingray.schema_instance.Unpacker" title="Permalink to this definition">¶</a></dt>
<dd><p>An Unpacker helps convert data from an <code class="docutils literal notranslate"><span class="pre">Instance</span></code>.
For NDInstances, this involves size calculations and value conversions.
For WBInstances and JSON, this is a pass-through because the sizes don’t matter and
the values are already Native Python objects.</p>
<p>An Unpacker is a generic procotol. A class that implements the protocol <strong>should</strong>
provide all of the methods.</p>
<p>It might make sense to define one more method</p>
<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.Unpacker.instance_iter">
<span class="sig-name descname"><span class="pre">instance_iter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sheet</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Iterator</span><span class="p"><span class="pre">[</span></span><span class="pre">Instance</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#stingray.schema_instance.Unpacker.instance_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterates through all the records of a given sheet.</p>
</dd></dl>

<p>There doesn’t seem to be a way to sensibly defined here.
There are too many variations on the instance types.</p>
<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.Unpacker.calcsize">
<span class="sig-name descname"><span class="pre">calcsize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">schema</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.Schema" title="stingray.schema_instance.Schema"><span class="pre">stingray.schema_instance.Schema</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#stingray.schema_instance.Unpacker.calcsize" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the size of this schema item.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>schema</strong> – A schema item to unpack</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The size</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.Unpacker.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#stingray.schema_instance.Unpacker.close" title="Permalink to this definition">¶</a></dt>
<dd><p>File close. This is generally delegated to
a workbook module.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.Unpacker.nav">
<span class="sig-name descname"><span class="pre">nav</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">schema</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.Schema" title="stingray.schema_instance.Schema"><span class="pre">stingray.schema_instance.Schema</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">instance</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">stingray.schema_instance.Instance</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#stingray.schema_instance.Nav" title="stingray.schema_instance.Nav"><span class="pre">stingray.schema_instance.Nav</span></a></span></span><a class="headerlink" href="#stingray.schema_instance.Unpacker.nav" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a <a class="reference internal" href="#stingray.schema_instance.Nav" title="stingray.schema_instance.Nav"><code class="xref py py-class docutils literal notranslate"><span class="pre">Nav</span></code></a> helper to locate items
within this instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>schema</strong> – Schema to apply.</p></li>
<li><p><strong>instance</strong> – Instance to navigate into</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A subclass of <a class="reference internal" href="#stingray.schema_instance.Nav" title="stingray.schema_instance.Nav"><code class="xref py py-class docutils literal notranslate"><span class="pre">Nav</span></code></a> appropriate to this unpacker.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.Unpacker.open">
<span class="sig-name descname"><span class="pre">open</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pathlib.Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_object</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">IO</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">IO</span><span class="p"><span class="pre">[</span></span><span class="pre">bytes</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#stingray.schema_instance.Unpacker.open" title="Permalink to this definition">¶</a></dt>
<dd><p>File open. This is generally delegated to
a workbook module.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code> to the file.</p></li>
<li><p><strong>file_object</strong> – Optional IO object in case the file is part of a ZIP archive.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.Unpacker.sheet_iter">
<span class="sig-name descname"><span class="pre">sheet_iter</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">collections.abc.Iterator</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#stingray.schema_instance.Unpacker.sheet_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Yields all the names of sheets of a workbook.
In the case of CSV or NDJSON files
or COBOL files, there’s only one sheet.</p>
<dl class="field-list simple">
<dt class="field-odd">Yields</dt>
<dd class="field-odd"><p>string sheet names.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.Unpacker.used">
<span class="sig-name descname"><span class="pre">used</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">count</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#stingray.schema_instance.Unpacker.used" title="Permalink to this definition">¶</a></dt>
<dd><p>Provide feedback to the unpacker on how many bytes
an instance actually uses.</p>
<p>This is for <code class="docutils literal notranslate"><span class="pre">RECFM=N</span></code> kinds of COBOL
files where there are no RDW headers on
the records, and the size must be deduced
from the number of bytes actually used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>count</strong> – bytes used.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.Unpacker.value">
<span class="sig-name descname"><span class="pre">value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">schema</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.Schema" title="stingray.schema_instance.Schema"><span class="pre">stingray.schema_instance.Schema</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">instance</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">stingray.schema_instance.Instance</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#stingray.schema_instance.Unpacker.value" title="Permalink to this definition">¶</a></dt>
<dd><p>Unpack the value for this schema item.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>schema</strong> – A schema item to unpack</p></li>
<li><p><strong>instance</strong> – An instance with a value to unpack</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The Python object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stingray.schema_instance.Delimited">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">stingray.schema_instance.</span></span><span class="sig-name descname"><span class="pre">Delimited</span></span><a class="headerlink" href="#stingray.schema_instance.Delimited" title="Permalink to this definition">¶</a></dt>
<dd><p>An Abstract Unpacker for delimited instances, i.e. <code class="docutils literal notranslate"><span class="pre">JSON</span></code> documents.</p>
<p>An instance will be <code class="docutils literal notranslate"><span class="pre">list[Any]</span> <span class="pre">|</span> <span class="pre">dict[str,</span> <span class="pre">Any]</span> <span class="pre">|</span> <span class="pre">Any</span></code>.
It will is built by a separate parser, often <code class="xref py py-mod docutils literal notranslate"><span class="pre">json</span></code>, YAML, or TOML.</p>
<p>For JSON/YAML/TOML, the instance <em>should</em> have the same structure as the schema.
JSONSchema validation can be applied to confirm this.</p>
<p>For XML, the source instance should be transformed into native Python objects, following
a schema definition. A schema structure may ignore XML tags or extract text from a tag
with a mixed content model.</p>
<p>The sizes and formats of delimited data don’t matter:
the <a class="reference internal" href="#stingray.schema_instance.Delimited.calcsize" title="stingray.schema_instance.Delimited.calcsize"><code class="xref py py-func docutils literal notranslate"><span class="pre">calcsize()</span></code></a> function returns 1 to act as a position in a sequence of values.</p>
<p>Concrete subclasses include open, close, and instance_iter.</p>
<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.Delimited.calcsize">
<span class="sig-name descname"><span class="pre">calcsize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">schema</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.Schema" title="stingray.schema_instance.Schema"><span class="pre">stingray.schema_instance.Schema</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#stingray.schema_instance.Delimited.calcsize" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the size of a field.
For delimited files, this isn’t relevant.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>schema</strong> – The field definition.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Literal[1].</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.Delimited.nav">
<span class="sig-name descname"><span class="pre">nav</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">schema</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.Schema" title="stingray.schema_instance.Schema"><span class="pre">stingray.schema_instance.Schema</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">instance</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.DInstance" title="stingray.schema_instance.DInstance"><span class="pre">stingray.schema_instance.DInstance</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#stingray.schema_instance.Nav" title="stingray.schema_instance.Nav"><span class="pre">stingray.schema_instance.Nav</span></a></span></span><a class="headerlink" href="#stingray.schema_instance.Delimited.nav" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a <a class="reference internal" href="#stingray.schema_instance.DNav" title="stingray.schema_instance.DNav"><code class="xref py py-class docutils literal notranslate"><span class="pre">DNav</span></code></a> helper to navigate through an <a class="reference internal" href="#stingray.schema_instance.DInstance" title="stingray.schema_instance.DInstance"><code class="xref py py-class docutils literal notranslate"><span class="pre">DInstance</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>schema</strong> – The schema for this instance</p></li>
<li><p><strong>instance</strong> – The instance</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>an <a class="reference internal" href="#stingray.schema_instance.DNav" title="stingray.schema_instance.DNav"><code class="xref py py-class docutils literal notranslate"><span class="pre">DNav</span></code></a> helper.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.Delimited.value">
<span class="sig-name descname"><span class="pre">value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">schema</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.Schema" title="stingray.schema_instance.Schema"><span class="pre">stingray.schema_instance.Schema</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">instance</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.DInstance" title="stingray.schema_instance.DInstance"><span class="pre">stingray.schema_instance.DInstance</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#stingray.schema_instance.Delimited.value" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the value of a field in a given <a class="reference internal" href="#stingray.schema_instance.DInstance" title="stingray.schema_instance.DInstance"><code class="xref py py-class docutils literal notranslate"><span class="pre">DInstance</span></code></a>.
The underlying parser for delimited data has already
created Python objects.</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">conversion</span></code> keyword was used in
the schema, this conversion function is applied.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>schema</strong> – The schema</p></li>
<li><p><strong>instance</strong> – The instance</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The instance</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stingray.schema_instance.EBCDIC">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">stingray.schema_instance.</span></span><span class="sig-name descname"><span class="pre">EBCDIC</span></span><a class="headerlink" href="#stingray.schema_instance.EBCDIC" title="Permalink to this definition">¶</a></dt>
<dd><p>Unpacker for Non-Delimited EBCDIC bytes.</p>
<p>Uses <code class="xref py py-mod docutils literal notranslate"><span class="pre">estruct</span></code> module for calcsize and value of Big-Endian, EBCDIC data.
This requires the “cobol” and “conversion” keywords, part of the extended vocabulary for COBOL.
A <cite>“cobol”</cite> keyword gets Usage and Picture values required to decode EBCDIC. 
A “conversion” keyword converts to a more useful Python type.</p>
<p>This assumes the 
COBOL encoded numeric can be <code class="docutils literal notranslate"><span class="pre">&quot;type&quot;:</span> <span class="pre">&quot;string&quot;</span></code> with additional <code class="docutils literal notranslate"><span class="pre">&quot;contentEncoding&quot;</span></code> details.</p>
<p>This class implements a <code class="docutils literal notranslate"><span class="pre">&quot;contentEncoding&quot;</span></code> using values of “packed-decimal”, and “cp037”,
to unwind COBOL Packed Decimal and Binary as strings of bytes.</p>
<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.EBCDIC.calcsize">
<span class="sig-name descname"><span class="pre">calcsize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">schema</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.Schema" title="stingray.schema_instance.Schema"><span class="pre">stingray.schema_instance.Schema</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#stingray.schema_instance.EBCDIC.calcsize" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the size of a field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>schema</strong> – The field definition.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The size.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.EBCDIC.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#stingray.schema_instance.EBCDIC.close" title="Permalink to this definition">¶</a></dt>
<dd><p>A file close suitable for most COBOL files.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.EBCDIC.instance_iter">
<span class="sig-name descname"><span class="pre">instance_iter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sheet</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recfm_class</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="stingray.estruct.html#stingray.estruct.RECFM_Reader" title="stingray.estruct.RECFM_Reader"><span class="pre">stingray.estruct.RECFM_Reader</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lrecl</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">collections.abc.Iterator</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#stingray.schema_instance.NDInstance" title="stingray.schema_instance.NDInstance"><span class="pre">stingray.schema_instance.NDInstance</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#stingray.schema_instance.EBCDIC.instance_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Yields all of the record instances in this file.</p>
<p>Delegates the details of instance iteration to a <code class="xref py py-class docutils literal notranslate"><span class="pre">estruct.RECFM_Reader</span></code> instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sheet</strong> – The name of the sheet to process; for COBOL files, this is ignored.</p></li>
<li><p><strong>recfm_class</strong> – a subclass of <code class="xref py py-class docutils literal notranslate"><span class="pre">estruct.RECFM_Reader</span></code></p></li>
<li><p><strong>lrecl</strong> – The expected logical record length of this file. This is used for RECFM without RDW’s.</p></li>
<li><p><strong>kwargs</strong> – Additional args provided to the <code class="xref py py-class docutils literal notranslate"><span class="pre">estruct.RECFM_Reader</span></code> instance that’s created.</p></li>
</ul>
</dd>
<dt class="field-even">Yields</dt>
<dd class="field-even"><p><a class="reference internal" href="#stingray.schema_instance.NDInstance" title="stingray.schema_instance.NDInstance"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDInstance</span></code></a> for each record in the file.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.EBCDIC.nav">
<span class="sig-name descname"><span class="pre">nav</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">schema</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.Schema" title="stingray.schema_instance.Schema"><span class="pre">stingray.schema_instance.Schema</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">instance</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.NDInstance" title="stingray.schema_instance.NDInstance"><span class="pre">stingray.schema_instance.NDInstance</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#stingray.schema_instance.NDNav" title="stingray.schema_instance.NDNav"><span class="pre">stingray.schema_instance.NDNav</span></a></span></span><a class="headerlink" href="#stingray.schema_instance.EBCDIC.nav" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a <a class="reference internal" href="#stingray.schema_instance.NDNav" title="stingray.schema_instance.NDNav"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDNav</span></code></a> helper to navigate through an <a class="reference internal" href="#stingray.schema_instance.NDInstance" title="stingray.schema_instance.NDInstance"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDInstance</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>schema</strong> – The schema for this instance</p></li>
<li><p><strong>instance</strong> – The instance</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>an <a class="reference internal" href="#stingray.schema_instance.NDNav" title="stingray.schema_instance.NDNav"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDNav</span></code></a> helper.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.EBCDIC.open">
<span class="sig-name descname"><span class="pre">open</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pathlib.Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_object</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">IO</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">IO</span><span class="p"><span class="pre">[</span></span><span class="pre">bytes</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#stingray.schema_instance.EBCDIC.open" title="Permalink to this definition">¶</a></dt>
<dd><p>A file open suitable for unpacking an EBCDIC-encoded file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – The <code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code></p></li>
<li><p><strong>file_object</strong> – An open</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.EBCDIC.sheet_iter">
<span class="sig-name descname"><span class="pre">sheet_iter</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">collections.abc.Iterator</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#stingray.schema_instance.EBCDIC.sheet_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Yields one name for the ‘sheet’ in this file.</p>
<dl class="field-list simple">
<dt class="field-odd">Yields</dt>
<dd class="field-odd"><p>Literal[“”]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.EBCDIC.used">
<span class="sig-name descname"><span class="pre">used</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">length</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#stingray.schema_instance.EBCDIC.used" title="Permalink to this definition">¶</a></dt>
<dd><p>This is used by a client application to
provide the number of bytes actually used.</p>
<p>This is delegated to the recfm_parser.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>length</strong> – number of bytes used.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.EBCDIC.value">
<span class="sig-name descname"><span class="pre">value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">schema</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.Schema" title="stingray.schema_instance.Schema"><span class="pre">stingray.schema_instance.Schema</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">instance</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.NDInstance" title="stingray.schema_instance.NDInstance"><span class="pre">stingray.schema_instance.NDInstance</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#stingray.schema_instance.EBCDIC.value" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the value of a field in a given <a class="reference internal" href="#stingray.schema_instance.NDInstance" title="stingray.schema_instance.NDInstance"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDInstance</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>schema</strong> – The field definition.</p></li>
<li><p><strong>instance</strong> – The instance to unpack.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The value.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stingray.schema_instance.Struct">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">stingray.schema_instance.</span></span><span class="sig-name descname"><span class="pre">Struct</span></span><a class="headerlink" href="#stingray.schema_instance.Struct" title="Permalink to this definition">¶</a></dt>
<dd><p>Unpacker for Non-Delimited native (i.e., not EBCDIC-encoding) bytes.</p>
<p>Uses built-in <code class="xref py py-mod docutils literal notranslate"><span class="pre">struct</span></code> module for calcsize and value.</p>
<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.Struct.calcsize">
<span class="sig-name descname"><span class="pre">calcsize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">schema</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.Schema" title="stingray.schema_instance.Schema"><span class="pre">stingray.schema_instance.Schema</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#stingray.schema_instance.Struct.calcsize" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the size of a field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>schema</strong> – The field definition.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The size.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.Struct.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#stingray.schema_instance.Struct.close" title="Permalink to this definition">¶</a></dt>
<dd><p>A file close suitable for most COBOL files.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.Struct.instance_iter">
<span class="sig-name descname"><span class="pre">instance_iter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sheet</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lrecl</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">collections.abc.Iterator</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#stingray.schema_instance.NDInstance" title="stingray.schema_instance.NDInstance"><span class="pre">stingray.schema_instance.NDInstance</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#stingray.schema_instance.Struct.instance_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Yields all the record instances in this file.</p>
<p>Delegates the details of instance iteration to a <code class="xref py py-class docutils literal notranslate"><span class="pre">estruct.RECFM_Reader</span></code> instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sheet</strong> – The name of the sheet to process; for COBOL files, this is ignored.</p></li>
<li><p><strong>lrecl</strong> – The expected logical record length of this file. Since there are no delimiters, this is the only way to know how long each record is.</p></li>
</ul>
</dd>
<dt class="field-even">Yields</dt>
<dd class="field-even"><p><a class="reference internal" href="#stingray.schema_instance.NDInstance" title="stingray.schema_instance.NDInstance"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDInstance</span></code></a> for each record in the file.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.Struct.nav">
<span class="sig-name descname"><span class="pre">nav</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">schema</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.Schema" title="stingray.schema_instance.Schema"><span class="pre">stingray.schema_instance.Schema</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">instance</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.NDInstance" title="stingray.schema_instance.NDInstance"><span class="pre">stingray.schema_instance.NDInstance</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#stingray.schema_instance.NDNav" title="stingray.schema_instance.NDNav"><span class="pre">stingray.schema_instance.NDNav</span></a></span></span><a class="headerlink" href="#stingray.schema_instance.Struct.nav" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a <a class="reference internal" href="#stingray.schema_instance.NDNav" title="stingray.schema_instance.NDNav"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDNav</span></code></a> helper to navigate through an <a class="reference internal" href="#stingray.schema_instance.NDInstance" title="stingray.schema_instance.NDInstance"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDInstance</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>schema</strong> – The schema for this instance</p></li>
<li><p><strong>instance</strong> – The instance</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>an <a class="reference internal" href="#stingray.schema_instance.NDNav" title="stingray.schema_instance.NDNav"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDNav</span></code></a> helper.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.Struct.open">
<span class="sig-name descname"><span class="pre">open</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pathlib.Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_object</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">IO</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">IO</span><span class="p"><span class="pre">[</span></span><span class="pre">bytes</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#stingray.schema_instance.Struct.open" title="Permalink to this definition">¶</a></dt>
<dd><p>A file open suitable for unpacking a bytes file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – The <code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code></p></li>
<li><p><strong>file_object</strong> – An open</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.Struct.sheet_iter">
<span class="sig-name descname"><span class="pre">sheet_iter</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">collections.abc.Iterator</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#stingray.schema_instance.Struct.sheet_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Yields one name for the ‘sheet’ in this file.</p>
<dl class="field-list simple">
<dt class="field-odd">Yields</dt>
<dd class="field-odd"><p>Literal[“”]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.Struct.struct_format">
<span class="sig-name descname"><span class="pre">struct_format</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">schema</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.Schema" title="stingray.schema_instance.Schema"><span class="pre">stingray.schema_instance.Schema</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#stingray.schema_instance.Struct.struct_format" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the <code class="xref py py-mod docutils literal notranslate"><span class="pre">struct</span></code> format string for an atomic Schema object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>schema</strong> – Schema</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>str format for <code class="xref py py-mod docutils literal notranslate"><span class="pre">struct</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.Struct.used">
<span class="sig-name descname"><span class="pre">used</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">length</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#stingray.schema_instance.Struct.used" title="Permalink to this definition">¶</a></dt>
<dd><p>This is used by a client application to
provide the number of bytes actually used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>length</strong> – number of bytes used.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.Struct.value">
<span class="sig-name descname"><span class="pre">value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">schema</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.Schema" title="stingray.schema_instance.Schema"><span class="pre">stingray.schema_instance.Schema</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">instance</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.NDInstance" title="stingray.schema_instance.NDInstance"><span class="pre">stingray.schema_instance.NDInstance</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#stingray.schema_instance.Struct.value" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the value of a field in a given <a class="reference internal" href="#stingray.schema_instance.NDInstance" title="stingray.schema_instance.NDInstance"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDInstance</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>schema</strong> – The field definition.</p></li>
<li><p><strong>instance</strong> – The instance to unpack.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The value.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stingray.schema_instance.TextUnpacker">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">stingray.schema_instance.</span></span><span class="sig-name descname"><span class="pre">TextUnpacker</span></span><a class="headerlink" href="#stingray.schema_instance.TextUnpacker" title="Permalink to this definition">¶</a></dt>
<dd><p>Unpacker for Non-Delimited text values.</p>
<p>Uses string slicing and built-ins.
This is for a native Unicode (or ASCII) text-based format.
If utf-16 is being used, this is effectively a Double-Byte Character Set used by COBOL.</p>
<p>A universal approach is to include <code class="docutils literal notranslate"><span class="pre">maxLength</span></code> (optionally <code class="docutils literal notranslate"><span class="pre">minLength</span></code>) attributes 
on each field. <code class="docutils literal notranslate"><span class="pre">maxLength</span></code> == the length of the field == <code class="docutils literal notranslate"><span class="pre">minLength</span></code>.</p>
<p>While it’s tempting to use “type”: “number” on this text data, it can be technically suspicious.
If file has strings, conversions may part of the application’s use 
of the data, not the data itself. We use a “conversion” keyword to do these conversions
from external string to internal Python object.</p>
<p>For various native bytes formats, this is a <cite>{“type”: “string”, “contentEncoding”: “struct-xxx”}</cite>
where the Python <code class="xref py py-mod docutils literal notranslate"><span class="pre">struct</span></code> module codes are used to define the number of interpretation of the bytes.</p>
<p>For COBOL, the “cobol” keyword provides USAGE and PICTURE. This defines size.
In this case, since it’s not in EBCDIC, we can use <code class="xref py py-mod docutils literal notranslate"><span class="pre">struct</span></code> to unpack COMP values.</p>
<p>This requires the “cobol” and “conversion” keywords, part of the extended vocabulary for COBOL.
A <cite>“cobol”</cite> keyword gets Usage and Picture values required to decode EBCDIC. 
A “conversion” keyword converts to a more useful Python type.</p>
<p>(An alternative approach is to use the <code class="docutils literal notranslate"><span class="pre">pattern</span></code> attribute to provide length information.
This is often {“type”: “string”, “pattern”: “^.{64}$”} or similar. This can provide a length.
Because patterns can be hard to reverse engineer, we don’t use this.)</p>
<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.TextUnpacker.calcsize">
<span class="sig-name descname"><span class="pre">calcsize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">schema</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.Schema" title="stingray.schema_instance.Schema"><span class="pre">stingray.schema_instance.Schema</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#stingray.schema_instance.TextUnpacker.calcsize" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the size of a field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>schema</strong> – The field definition.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The size.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.TextUnpacker.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#stingray.schema_instance.TextUnpacker.close" title="Permalink to this definition">¶</a></dt>
<dd><p>A file close suitable for most COBOL files.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.TextUnpacker.instance_iter">
<span class="sig-name descname"><span class="pre">instance_iter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sheet</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">collections.abc.Iterator</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#stingray.schema_instance.NDInstance" title="stingray.schema_instance.NDInstance"><span class="pre">stingray.schema_instance.NDInstance</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#stingray.schema_instance.TextUnpacker.instance_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Yields all the record instances in this file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sheet</strong> – The name of the sheet to process; for COBOL files, this is ignored.</p></li>
<li><p><strong>kwargs</strong> – Not used.</p></li>
</ul>
</dd>
<dt class="field-even">Yields</dt>
<dd class="field-even"><p>Instances of rows. Text files are newline delimited.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.TextUnpacker.nav">
<span class="sig-name descname"><span class="pre">nav</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">schema</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.Schema" title="stingray.schema_instance.Schema"><span class="pre">stingray.schema_instance.Schema</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">instance</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.NDInstance" title="stingray.schema_instance.NDInstance"><span class="pre">stingray.schema_instance.NDInstance</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#stingray.schema_instance.NDNav" title="stingray.schema_instance.NDNav"><span class="pre">stingray.schema_instance.NDNav</span></a></span></span><a class="headerlink" href="#stingray.schema_instance.TextUnpacker.nav" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a <a class="reference internal" href="#stingray.schema_instance.NDNav" title="stingray.schema_instance.NDNav"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDNav</span></code></a> helper to navigate through an <a class="reference internal" href="#stingray.schema_instance.NDInstance" title="stingray.schema_instance.NDInstance"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDInstance</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>schema</strong> – The schema for this instance</p></li>
<li><p><strong>instance</strong> – The instance</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>an <a class="reference internal" href="#stingray.schema_instance.NDNav" title="stingray.schema_instance.NDNav"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDNav</span></code></a> helper.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.TextUnpacker.open">
<span class="sig-name descname"><span class="pre">open</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pathlib.Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_object</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">IO</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">IO</span><span class="p"><span class="pre">[</span></span><span class="pre">bytes</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#stingray.schema_instance.TextUnpacker.open" title="Permalink to this definition">¶</a></dt>
<dd><p>A file open suitable for unpacking a Text COBOL file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – The <code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code></p></li>
<li><p><strong>file_object</strong> – An open</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.TextUnpacker.sheet_iter">
<span class="sig-name descname"><span class="pre">sheet_iter</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">collections.abc.Iterator</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#stingray.schema_instance.TextUnpacker.sheet_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Yields one name for the ‘sheet’ in this file.</p>
<dl class="field-list simple">
<dt class="field-odd">Yields</dt>
<dd class="field-odd"><p>Literal[“”]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.TextUnpacker.value">
<span class="sig-name descname"><span class="pre">value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">schema</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.Schema" title="stingray.schema_instance.Schema"><span class="pre">stingray.schema_instance.Schema</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">instance</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.NDInstance" title="stingray.schema_instance.NDInstance"><span class="pre">stingray.schema_instance.NDInstance</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#stingray.schema_instance.TextUnpacker.value" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the value of a field in a given <a class="reference internal" href="#stingray.schema_instance.NDInstance" title="stingray.schema_instance.NDInstance"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDInstance</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>schema</strong> – The field definition.</p></li>
<li><p><strong>instance</strong> – The instance to unpack.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The value.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stingray.schema_instance.WBUnpacker">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">stingray.schema_instance.</span></span><span class="sig-name descname"><span class="pre">WBUnpacker</span></span><a class="headerlink" href="#stingray.schema_instance.WBUnpacker" title="Permalink to this definition">¶</a></dt>
<dd><p>Unpacker for Workbook-defined values.</p>
<p>Most of WBInstances defer to another module for unpacking.
CSV, however, relies on the <code class="xref py py-mod docutils literal notranslate"><span class="pre">csv</span></code> module, where the instance is <code class="docutils literal notranslate"><span class="pre">list[str]</span></code>.</p>
<p>While it’s tempting to use “type”: “number” on CSV data, it’s technically suspicious.
The file has strings, and only strings. Conversions are part of the application’s use 
of the data, not the data itself. The schema can use the <code class="docutils literal notranslate"><span class="pre">&quot;conversion&quot;</span></code> keyword
to specify one of the conversion functions.</p>
<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.WBUnpacker.calcsize">
<span class="sig-name descname"><span class="pre">calcsize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">schema</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.Schema" title="stingray.schema_instance.Schema"><span class="pre">stingray.schema_instance.Schema</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#stingray.schema_instance.WBUnpacker.calcsize" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the size of a field.
For delimited files, this isn’t relevant.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>schema</strong> – The field definition.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Literal[1].</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.WBUnpacker.nav">
<span class="sig-name descname"><span class="pre">nav</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">schema</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.Schema" title="stingray.schema_instance.Schema"><span class="pre">stingray.schema_instance.Schema</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">instance</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.WBInstance" title="stingray.schema_instance.WBInstance"><span class="pre">stingray.schema_instance.WBInstance</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#stingray.schema_instance.Nav" title="stingray.schema_instance.Nav"><span class="pre">stingray.schema_instance.Nav</span></a></span></span><a class="headerlink" href="#stingray.schema_instance.WBUnpacker.nav" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a <a class="reference internal" href="#stingray.schema_instance.WBNav" title="stingray.schema_instance.WBNav"><code class="xref py py-class docutils literal notranslate"><span class="pre">WBNav</span></code></a> helper to navigate through an <a class="reference internal" href="#stingray.schema_instance.WBInstance" title="stingray.schema_instance.WBInstance"><code class="xref py py-class docutils literal notranslate"><span class="pre">WBInstance</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>schema</strong> – The schema for this instance</p></li>
<li><p><strong>instance</strong> – The instance</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>an <a class="reference internal" href="#stingray.schema_instance.WBNav" title="stingray.schema_instance.WBNav"><code class="xref py py-class docutils literal notranslate"><span class="pre">WBNav</span></code></a> helper.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.WBUnpacker.value">
<span class="sig-name descname"><span class="pre">value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">schema</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.Schema" title="stingray.schema_instance.Schema"><span class="pre">stingray.schema_instance.Schema</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">instance</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.WBInstance" title="stingray.schema_instance.WBInstance"><span class="pre">stingray.schema_instance.WBInstance</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#stingray.schema_instance.WBUnpacker.value" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the value of a field in a given <a class="reference internal" href="#stingray.schema_instance.DInstance" title="stingray.schema_instance.DInstance"><code class="xref py py-class docutils literal notranslate"><span class="pre">DInstance</span></code></a>.</p>
<p>The underlying parser for the workbook has already
created Python objects. We apply a final conversion
to get from a workbook object to a more useful
Python object.</p>
<p>The schema voculary extension “conversion”
is used to locate a suitable conversion function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>schema</strong> – The schema</p></li>
<li><p><strong>instance</strong> – The instance</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An instance with the conversion applied.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="schema-and-instance-navigation">
<h2>Schema and Instance Navigation<a class="headerlink" href="#schema-and-instance-navigation" title="Permalink to this headline">¶</a></h2>
<p>This is the core abstraction for a <cite>Row</cite> of a <cite>Sheet</cite>. Or a document in an JSON-Newline file. Or a row in a CSV file or other workbook. It’s one document in an interable YAML file. (While there’s no trivial mapping to TOML files, a subclass can locate sections or objects within a section that are treated as rows.)</p>
<p>A <cite>Row</cite> is a collection of named values. A <cite>Schema</cite> provides name and type information for unpacking the values. In the case of non-delimited file formats, navigation becomes a complex problem and <cite>Location</cite> objects are created. With COBOL <cite>REDEFINES</cite> and <cite>OCCURS DEPENDING ON</cite> clauses, fields are found in positions unique to each <cite>NDInstance</cite>.</p>
<p>The names for attributes should be provided as <cite>“$anchor”</cite> values to make them visible. In the case of simple workbook files, the rows are flat and property names are a useful surrogate for anchors.</p>
<p>A <cite>Row</cite> has a plug-in strategy for navigation among cells in the workbook or fields in a JSON object, or the more complex structures present in a Non-Delimited File.</p>
<p>The abstract <cite>Nav</cite> class provides unifieid navigation for delimited as well as non-delimited rows. The <cite>NDNav</cite> subclass handles non-delimited files where <cite>Location</cite> objects are required. The <cite>DNav</cite> handles JSON and other delimited structures. The <cite>WBNav</cite> subclass wraps workbook modules.</p>
<p>An <cite>NDNav</cite> instance provides a context that can help to move through an <cite>NDInstance</cite> of non-delimited data using a <cite>Schema</cite>.  These are created by a <cite>LocationMaker</cite> instance because this navigation so intimately involved in creating <cite>Location</cite> objects to find structures.</p>
<p>A separate <cite>DNav</cite> subclass is a context that navigates through delimited objects where the object structure matches the schema structure. In the case of JSON/YAML/TOML, the operations are trivially delegated to the underlying native Python object; it’s already been unpacked.</p>
<p>A third <cite>WBNav</cite> subclass handles CSV, XML and Workbook files. These rely on an underlying unpacker to handle the details of navigation, which are specific to a parser. The <cite>WBNav</cite> is a <strong>Facade</strong> over these various kinds of parsers.</p>
<p>All of these are plug-in strategies used by a <cite>Row</cite> that provides a uniform wrapper.</p>
<p class="plantuml">
<img src="../../_images/plantuml-c328fa4b165f9391d74a72229a54bac48fe44516.png" alt="&#64;startuml
    abstract class Unpacker

    abstract class Row {
        name(string): Nav
        index(int): Nav
    }

    Row ..&gt; Unpacker
    abstract class NDInstance {
        name(string): NDNav
        index(int): NDNav
    }

    Unpacker --&gt; Nav : creates

    abstract class Nav

    class NDNav {
        name(string): NDNav
        index(int): NDNav
        value(schema): Any
    }

    Nav &lt;|-- NDNav
    Row --&gt; NDNav
    NDNav --&gt; NDInstance

    class Location

    NDNav --&gt; Location
    class DNav {
        name(string): DNav
        value(schema): Any
    }

    Nav &lt;|-- DNav
    Row --&gt; DNav
    DNav --&gt; JSON

    class WBNav {
        name(string): DNav
        value(schema): Any
    }

    Row --&gt; WBNav
    Nav &lt;|-- WBNav
&#64;enduml"/>
</p>
<p>We could try to create a subclass of <code class="docutils literal notranslate"><span class="pre">dict</span></code> that added methods to support <code class="docutils literal notranslate"><span class="pre">Nav</span></code> and <code class="docutils literal notranslate"><span class="pre">DNav</span></code> behaviors.
This seems a bit complicated, since we’re generally dealing with a <code class="xref py py-class docutils literal notranslate"><span class="pre">Row</span></code>.
This class creates an appropriate <a class="reference internal" href="#stingray.schema_instance.NDInstance" title="stingray.schema_instance.NDInstance"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDInstance</span></code></a> or <a class="reference internal" href="#stingray.schema_instance.WBInstance" title="stingray.schema_instance.WBInstance"><code class="xref py py-class docutils literal notranslate"><span class="pre">WBInstance</span></code></a> based in the
Workbook’s <a class="reference internal" href="#stingray.schema_instance.Unpacker" title="stingray.schema_instance.Unpacker"><code class="xref py py-class docutils literal notranslate"><span class="pre">Unpacker</span></code></a> subclass.</p>
<p>A separate plug-in <strong>Strategy</strong> acts as an <strong>Adapter</strong> over the distinct implementation details.</p>
<dl class="py class">
<dt class="sig sig-object py" id="stingray.schema_instance.Nav">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">stingray.schema_instance.</span></span><span class="sig-name descname"><span class="pre">Nav</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stingray.schema_instance.Nav" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper to navigate into items by field name or index into an array.</p>
<ul class="simple">
<li><p>For Non-Delimited instances, names as well as indices are required for object and array navigation.
Further, a <a class="reference internal" href="#stingray.schema_instance.Location" title="stingray.schema_instance.Location"><code class="xref py py-class docutils literal notranslate"><span class="pre">Location</span></code></a> is also required.</p></li>
<li><p>For Delimited instances, a name or an index can be used, depending on what the underlying Python
Instance object is. Dictionaries use names, lists use indices.</p></li>
<li><p>For Workbook instances, we only know the cells of a row by name in the schema and convert to a position.</p></li>
</ul>
<p>A :py:class`Nav` is built by an <a class="reference internal" href="#stingray.schema_instance.Unpacker" title="stingray.schema_instance.Unpacker"><code class="xref py py-class docutils literal notranslate"><span class="pre">Unpacker</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">unpacker</span><span class="o">.</span><span class="n">nav</span><span class="p">(</span><span class="n">schema</span><span class="p">,</span> <span class="n">instance</span><span class="p">)</span>
</pre></div>
</div>
<p>This provides a common protocol for building navigation helpers.</p>
<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.Nav.dump">
<span class="sig-name descname"><span class="pre">dump</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#stingray.schema_instance.Nav.dump" title="Permalink to this definition">¶</a></dt>
<dd><p>A helpful dump of this schema and all subschema.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.Nav.index">
<span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#stingray.schema_instance.Nav" title="stingray.schema_instance.Nav"><span class="pre">stingray.schema_instance.Nav</span></a></span></span><a class="headerlink" href="#stingray.schema_instance.Nav.index" title="Permalink to this definition">¶</a></dt>
<dd><p>Navigate into an array by index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>index</strong> – index</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>new <a class="reference internal" href="#stingray.schema_instance.Nav" title="stingray.schema_instance.Nav"><code class="xref py py-class docutils literal notranslate"><span class="pre">Nav</span></code></a> for the indexed instance within items</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.Nav.name">
<span class="sig-name descname"><span class="pre">name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#stingray.schema_instance.Nav" title="stingray.schema_instance.Nav"><span class="pre">stingray.schema_instance.Nav</span></a></span></span><a class="headerlink" href="#stingray.schema_instance.Nav.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Navigate into an object by name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>name</strong> – name</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>new <a class="reference internal" href="#stingray.schema_instance.Nav" title="stingray.schema_instance.Nav"><code class="xref py py-class docutils literal notranslate"><span class="pre">Nav</span></code></a> for the named subschema.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.Nav.value">
<span class="sig-name descname"><span class="pre">value</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#stingray.schema_instance.Nav.value" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the value of this instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Instance value.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stingray.schema_instance.DNav">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">stingray.schema_instance.</span></span><span class="sig-name descname"><span class="pre">DNav</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unpacker</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.Unpacker" title="stingray.schema_instance.Unpacker"><span class="pre">stingray.schema_instance.Unpacker</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#stingray.schema_instance.DInstance" title="stingray.schema_instance.DInstance"><span class="pre">stingray.schema_instance.DInstance</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">schema</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.Schema" title="stingray.schema_instance.Schema"><span class="pre">stingray.schema_instance.Schema</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">instance</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span> </span><span class="pre">bool</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">typing.Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">typing.Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stingray.schema_instance.DNav" title="Permalink to this definition">¶</a></dt>
<dd><p>Navigate through a <a class="reference internal" href="#stingray.schema_instance.DInstance" title="stingray.schema_instance.DInstance"><code class="xref py py-class docutils literal notranslate"><span class="pre">DInstance</span></code></a> using a <code class="docutils literal notranslate"><span class="pre">Schema</span></code>.
This is a wrapper around a <code class="docutils literal notranslate"><span class="pre">JSON</span></code> document.</p>
<p>Note that these objects have an inherent ambiguity. 
A JSON document can have the form of a dictionary with names and values.
The schema <em>also</em> names the properties and suggests types.
If the two don’t agree, that’s an instance error, spotted by schema validation.</p>
<p>The JSON/YAML/TOML parsers have types implied by syntax and the schema <em>also</em> has types.</p>
<p>We need an option to validate the instance against the schema.</p>
<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.DNav.dump">
<span class="sig-name descname"><span class="pre">dump</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#stingray.schema_instance.DNav.dump" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints this instance and all its children.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.DNav.index">
<span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#stingray.schema_instance.DNav" title="stingray.schema_instance.DNav"><span class="pre">stingray.schema_instance.DNav</span></a></span></span><a class="headerlink" href="#stingray.schema_instance.DNav.index" title="Permalink to this definition">¶</a></dt>
<dd><p>Locate the given index in an array.</p>
<p>Compute an offset into the array of items.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>index</strong> – the array index value</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An DNav for the subschema of an item at the given index.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.DNav.name">
<span class="sig-name descname"><span class="pre">name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#stingray.schema_instance.DNav" title="stingray.schema_instance.DNav"><span class="pre">stingray.schema_instance.DNav</span></a></span></span><a class="headerlink" href="#stingray.schema_instance.DNav.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Locate the “$anchor” in this Object’s properties.
Return a new <code class="docutils literal notranslate"><span class="pre">DNav</span></code> for the requested anchor or property name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>name</strong> – name of anchor</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>DNav for the subschema for the given property</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.DNav.value">
<span class="sig-name descname"><span class="pre">value</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#stingray.schema_instance.DNav.value" title="Permalink to this definition">¶</a></dt>
<dd><p>The final Python value from the current schema.
Consider refactoring to use Unpacker explicitly</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Python object for the current instance.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stingray.schema_instance.NDNav">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">stingray.schema_instance.</span></span><span class="sig-name descname"><span class="pre">NDNav</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unpacker</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.Unpacker" title="stingray.schema_instance.Unpacker"><span class="pre">stingray.schema_instance.Unpacker</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#stingray.schema_instance.NDInstance" title="stingray.schema_instance.NDInstance"><span class="pre">stingray.schema_instance.NDInstance</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">location</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.Location" title="stingray.schema_instance.Location"><span class="pre">stingray.schema_instance.Location</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">instance</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.NDInstance" title="stingray.schema_instance.NDInstance"><span class="pre">stingray.schema_instance.NDInstance</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stingray.schema_instance.NDNav" title="Permalink to this definition">¶</a></dt>
<dd><p>Navigate through an <code class="docutils literal notranslate"><span class="pre">NDInstance</span></code> using <code class="docutils literal notranslate"><span class="pre">Location</span></code> as a helper.</p>
<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.NDNav.dump">
<span class="sig-name descname"><span class="pre">dump</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#stingray.schema_instance.NDNav.dump" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints this Location and all children.</p>
<p>Navigates a non-delimited Schema using <a class="reference internal" href="#stingray.schema_instance.Location" title="stingray.schema_instance.Location"><code class="xref py py-class docutils literal notranslate"><span class="pre">Location</span></code></a> (based on the Schema)
to expose values in the instance.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.NDNav.index">
<span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#stingray.schema_instance.NDNav" title="stingray.schema_instance.NDNav"><span class="pre">stingray.schema_instance.NDNav</span></a></span></span><a class="headerlink" href="#stingray.schema_instance.NDNav.index" title="Permalink to this definition">¶</a></dt>
<dd><p>Locate the given index in an array.</p>
<p>Compute an offset into the array of items.
Create a special <code class="docutils literal notranslate"><span class="pre">Location</span></code> for the requested index value.
The location, attribute, assigned to <code class="docutils literal notranslate"><span class="pre">base_location</span></code>, is for index == 0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>index</strong> – the array index value</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An NDNav for the subschema of an item at the given index.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.NDNav.name">
<span class="sig-name descname"><span class="pre">name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#stingray.schema_instance.NDNav" title="stingray.schema_instance.NDNav"><span class="pre">stingray.schema_instance.NDNav</span></a></span></span><a class="headerlink" href="#stingray.schema_instance.NDNav.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Locate the “$anchor” in this Object’s properties and the related <code class="docutils literal notranslate"><span class="pre">Location</span></code>.
Return a new <code class="docutils literal notranslate"><span class="pre">NDNav</span></code> for the requested anchor or property name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>name</strong> – name of anchor</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>NDNav for the subschema for the given property</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.NDNav.raw">
<span class="sig-name descname"><span class="pre">raw</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#stingray.schema_instance.NDNav.raw" title="Permalink to this definition">¶</a></dt>
<dd><p>Raw bytes (or text) from the current schema and location.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>raw value from the current location.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.NDNav.raw_instance">
<span class="sig-name descname"><span class="pre">raw_instance</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#stingray.schema_instance.NDInstance" title="stingray.schema_instance.NDInstance"><span class="pre">stingray.schema_instance.NDInstance</span></a></span></span><a class="headerlink" href="#stingray.schema_instance.NDNav.raw_instance" title="Permalink to this definition">¶</a></dt>
<dd><p>Clone a piece of this instance as a new <a class="reference internal" href="#stingray.schema_instance.NDInstance" title="stingray.schema_instance.NDInstance"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDInstance</span></code></a> object.
Since NDInstance is Union[BytesInstance, TextInstance], there are two paths:
a new bytes or a new str.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>New <a class="reference internal" href="#stingray.schema_instance.NDInstance" title="stingray.schema_instance.NDInstance"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDInstance</span></code></a> for this loocation.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stingray.schema_instance.NDNav.schema">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">schema</span></span><em class="property"><span class="pre">:</span> <a class="reference internal" href="#stingray.schema_instance.Schema" title="stingray.schema_instance.Schema"><span class="pre">stingray.schema_instance.Schema</span></a></em><a class="headerlink" href="#stingray.schema_instance.NDNav.schema" title="Permalink to this definition">¶</a></dt>
<dd><p>Provide the schema.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Schema for the Location.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.NDNav.value">
<span class="sig-name descname"><span class="pre">value</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#stingray.schema_instance.NDNav.value" title="Permalink to this definition">¶</a></dt>
<dd><p>The final Python value from the current schema and location.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>unpacked value from the current location.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stingray.schema_instance.WBNav">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">stingray.schema_instance.</span></span><span class="sig-name descname"><span class="pre">WBNav</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unpacker</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.Unpacker" title="stingray.schema_instance.Unpacker"><span class="pre">stingray.schema_instance.Unpacker</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#stingray.schema_instance.WBInstance" title="stingray.schema_instance.WBInstance"><span class="pre">stingray.schema_instance.WBInstance</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">schema</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.Schema" title="stingray.schema_instance.Schema"><span class="pre">stingray.schema_instance.Schema</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">instance</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.WBInstance" title="stingray.schema_instance.WBInstance"><span class="pre">stingray.schema_instance.WBInstance</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stingray.schema_instance.WBNav" title="Permalink to this definition">¶</a></dt>
<dd><p>Navigate through a workbook <code class="docutils literal notranslate"><span class="pre">WBInstance</span></code> using a <code class="docutils literal notranslate"><span class="pre">Schema</span></code>.</p>
<p>A Workbook Row is a <code class="docutils literal notranslate"><span class="pre">Sequence[Any]</span></code> of cell values. Therefore, navigation
by name translates to a position within the <code class="docutils literal notranslate"><span class="pre">WBInstance</span></code> row.</p>
<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.WBNav.dump">
<span class="sig-name descname"><span class="pre">dump</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#stingray.schema_instance.WBNav.dump" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints this instance and all its children.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.WBNav.index">
<span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#stingray.schema_instance.WBNav" title="stingray.schema_instance.WBNav"><span class="pre">stingray.schema_instance.WBNav</span></a></span></span><a class="headerlink" href="#stingray.schema_instance.WBNav.index" title="Permalink to this definition">¶</a></dt>
<dd><p>Locate the given index in an array.</p>
<p>Compute an offset into the array of items.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>index</strong> – the array index value</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An WBNav for the subschema of an item at the given index.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.WBNav.name">
<span class="sig-name descname"><span class="pre">name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#stingray.schema_instance.WBNav" title="stingray.schema_instance.WBNav"><span class="pre">stingray.schema_instance.WBNav</span></a></span></span><a class="headerlink" href="#stingray.schema_instance.WBNav.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Locate the “$anchor” in this Object’s properties.
Return a new <code class="docutils literal notranslate"><span class="pre">DNav</span></code> for the requested anchor or property name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>name</strong> – name of anchor</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>WBNav for the subschema for the given property</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.WBNav.value">
<span class="sig-name descname"><span class="pre">value</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#stingray.schema_instance.WBNav.value" title="Permalink to this definition">¶</a></dt>
<dd><p>The final Python value from the current schema.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>value created by the Workbook unpacker</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stingray.schema_instance.CSVNav">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">stingray.schema_instance.</span></span><span class="sig-name descname"><span class="pre">CSVNav</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unpacker</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.Unpacker" title="stingray.schema_instance.Unpacker"><span class="pre">stingray.schema_instance.Unpacker</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#stingray.schema_instance.WBInstance" title="stingray.schema_instance.WBInstance"><span class="pre">stingray.schema_instance.WBInstance</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">schema</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.Schema" title="stingray.schema_instance.Schema"><span class="pre">stingray.schema_instance.Schema</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">instance</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.WBInstance" title="stingray.schema_instance.WBInstance"><span class="pre">stingray.schema_instance.WBInstance</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stingray.schema_instance.CSVNav" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="locations">
<h2>Locations<a class="headerlink" href="#locations" title="Permalink to this headline">¶</a></h2>
<p>A <cite>Location</cite> is required to unpack bytes from non-delimited instances. This is a feature of the <cite>NonDelimited</cite> subclass of <cite>Unpacker</cite> and the associated <cite>NDNav</cite> class.</p>
<p>It’s common to consider the <cite>Location</cite> details as “decoration” applied to a <cite>Schema</cite>. An implementation that decorates the schema requires a stateful schema and cant process more than one <cite>Instance</cite> at a time.</p>
<p>We prefer to have <cite>Location</cite> objects as “wrappers” on <cite>Schema</cite> objects; the <cite>Schema</cite> remains stateless and we process multiple <cite>NDInstance</cite> objects with distinct <cite>Location</cite> objects.</p>
<p>Each <cite>Location</cite> object contains a <cite>Schema</cite> object and additional start and end offsets. This may be based on the values of dependencies like <cite>OCCURS DEPENDING ON</cite> and <cite>REDEFINES</cite>.</p>
<p>The abstract <cite>Location</cite> class is built by a <cite>LocationMaker</cite> to provide specific offsets and sizes for non-delimited files with <cite>OCCURS DEPENDING ON</cite>. The <cite>LocationMaker</cite> seems to be part of the <cite>Unpacker</cite> class definition.</p>
<p class="plantuml">
<img src="../../_images/plantuml-09b379842491b1be12cd70e69aaa98932944aae1.png" alt="&#64;startuml
    abstract class Unpacker {
        value(schema, NDInstance): Any
        size(schema): int
        location(schema, NDInstance): Location
    }
    abstract class Schema {
        type: string
    }
    abstract class NDInstance

    class Location {
        schema: Schema
        unpacker: Unpacker
        start: int
        end: int
        value(NDInstance): Any
    }

    Location ...&gt; NDInstance
    Unpacker -&gt; Location
    Location -&gt; Schema
    Unpacker .&gt; Schema : &quot;Uses&quot;

    class AtomicLocation
    Location &lt;|-- AtomicLocation
    class ArrayLocation
    Location &lt;|-- ArrayLocation
    class ObjectLocation
    Location &lt;|-- ObjectLocation
    class OneOfLocation
    Location &lt;|-- OneOfLocation
    class RefToLocation
    Location &lt;|-- RefToLocation
&#64;enduml"/>
</p>
<dl class="py class">
<dt class="sig sig-object py" id="stingray.schema_instance.Location">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">stingray.schema_instance.</span></span><span class="sig-name descname"><span class="pre">Location</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">schema</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.Schema" title="stingray.schema_instance.Schema"><span class="pre">stingray.schema_instance.Schema</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stingray.schema_instance.Location" title="Permalink to this definition">¶</a></dt>
<dd><p>A Location is used to navigate within an <a class="reference internal" href="#stingray.schema_instance.NDInstance" title="stingray.schema_instance.NDInstance"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDInstance</span></code></a> objects.</p>
<p>These are created by a <a class="reference internal" href="#stingray.schema_instance.NDNav" title="stingray.schema_instance.NDNav"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDNav</span></code></a> instance.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">Unpacker[NDInstance]</span></code> strategy is a subclass of NonDelimited,
one of EBCDIC(), Struct(), or TextUnpacker().</p>
<p>The value() method delegates the work to the <a class="reference internal" href="#stingray.schema_instance.Unpacker" title="stingray.schema_instance.Unpacker"><code class="xref py py-class docutils literal notranslate"><span class="pre">Unpacker</span></code></a> strategy.</p>
<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.Location.dump_iter">
<em class="property"><span class="pre">abstract</span> </em><span class="sig-name descname"><span class="pre">dump_iter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nav</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.NDNav" title="stingray.schema_instance.NDNav"><span class="pre">stingray.schema_instance.NDNav</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">indent</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">collections.abc.Iterator</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">'Location'</span><span class="p"><span class="pre">,</span> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">typing.Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bytes</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">typing.Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#stingray.schema_instance.Location.dump_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Dump this location and all children in the schema.</p>
<dl class="field-list simple">
<dt class="field-odd">Yields</dt>
<dd class="field-odd"><p>tuples of (indent, Location, array indices, raw bytes, value)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.Location.raw">
<em class="property"><span class="pre">abstract</span> </em><span class="sig-name descname"><span class="pre">raw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">instance</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.NDInstance" title="stingray.schema_instance.NDInstance"><span class="pre">stingray.schema_instance.NDInstance</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#stingray.schema_instance.Location.raw" title="Permalink to this definition">¶</a></dt>
<dd><p>The raw bytes of this location.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stingray.schema_instance.Location.referent">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">referent</span></span><em class="property"><span class="pre">:</span> <a class="reference internal" href="#stingray.schema_instance.Location" title="stingray.schema_instance.Location"><span class="pre">stingray.schema_instance.Location</span></a></em><a class="headerlink" href="#stingray.schema_instance.Location.referent" title="Permalink to this definition">¶</a></dt>
<dd><p>Most things refer to themselves. A RefToLocation, however, overrides this.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.Location.value">
<em class="property"><span class="pre">abstract</span> </em><span class="sig-name descname"><span class="pre">value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">instance</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.NDInstance" title="stingray.schema_instance.NDInstance"><span class="pre">stingray.schema_instance.NDInstance</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#stingray.schema_instance.Location.value" title="Permalink to this definition">¶</a></dt>
<dd><p>The value of this location.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stingray.schema_instance.ArrayLocation">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">stingray.schema_instance.</span></span><span class="sig-name descname"><span class="pre">ArrayLocation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">schema</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.Schema" title="stingray.schema_instance.Schema"><span class="pre">stingray.schema_instance.Schema</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">item_size</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">item_count</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">items</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.Location" title="stingray.schema_instance.Location"><span class="pre">stingray.schema_instance.Location</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stingray.schema_instance.ArrayLocation" title="Permalink to this definition">¶</a></dt>
<dd><p>The location of an array of instances with the same schema. A COBOL <code class="docutils literal notranslate"><span class="pre">OCCURS</span></code> item.</p>
<p>type(Schema) == ArraySchema.</p>
<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.ArrayLocation.dump_iter">
<span class="sig-name descname"><span class="pre">dump_iter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nav</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.NDNav" title="stingray.schema_instance.NDNav"><span class="pre">stingray.schema_instance.NDNav</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">indent</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">collections.abc.Iterator</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="#stingray.schema_instance.Location" title="stingray.schema_instance.Location"><span class="pre">stingray.schema_instance.Location</span></a><span class="p"><span class="pre">,</span> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">typing.Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bytes</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">typing.Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#stingray.schema_instance.ArrayLocation.dump_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Dump the first item of this array location.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nav</strong> – The parent <a class="reference internal" href="#stingray.schema_instance.NDNav" title="stingray.schema_instance.NDNav"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDNav</span></code></a> instance with schema details.</p></li>
<li><p><strong>indent</strong> – The indentation level</p></li>
</ul>
</dd>
<dt class="field-even">Yields</dt>
<dd class="field-even"><p>tuples of (indent, Location, array indices, raw bytes, value)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.ArrayLocation.raw">
<span class="sig-name descname"><span class="pre">raw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">instance</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.NDInstance" title="stingray.schema_instance.NDInstance"><span class="pre">stingray.schema_instance.NDInstance</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#stingray.schema_instance.ArrayLocation.raw" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the bytes of this location.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>instance</strong> – The Non-Delimited Instance</p></li>
<li><p><strong>offset</strong> – The offset into the sequence</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>instance bytes (or characters if it’s a text instance.)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.ArrayLocation.value">
<span class="sig-name descname"><span class="pre">value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">instance</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.NDInstance" title="stingray.schema_instance.NDInstance"><span class="pre">stingray.schema_instance.NDInstance</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#stingray.schema_instance.ArrayLocation.value" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the value of this location.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>instance</strong> – The Non-Delimited Instance</p></li>
<li><p><strong>offset</strong> – The offset into the sequence</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The Python object unpacked from this location</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stingray.schema_instance.AtomicLocation">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">stingray.schema_instance.</span></span><span class="sig-name descname"><span class="pre">AtomicLocation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">schema</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.Schema" title="stingray.schema_instance.Schema"><span class="pre">stingray.schema_instance.Schema</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stingray.schema_instance.AtomicLocation" title="Permalink to this definition">¶</a></dt>
<dd><p>The location of a COBOL elementary item.</p>
<p>type(Schema) == AtomicSchema.</p>
<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.AtomicLocation.dump_iter">
<span class="sig-name descname"><span class="pre">dump_iter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nav</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.NDNav" title="stingray.schema_instance.NDNav"><span class="pre">stingray.schema_instance.NDNav</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">indent</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">collections.abc.Iterator</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="#stingray.schema_instance.Location" title="stingray.schema_instance.Location"><span class="pre">stingray.schema_instance.Location</span></a><span class="p"><span class="pre">,</span> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">typing.Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bytes</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">typing.Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#stingray.schema_instance.AtomicLocation.dump_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Dump this atomic location.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nav</strong> – The parent <a class="reference internal" href="#stingray.schema_instance.NDNav" title="stingray.schema_instance.NDNav"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDNav</span></code></a> instance with schema details.</p></li>
<li><p><strong>indent</strong> – The indentation level</p></li>
</ul>
</dd>
<dt class="field-even">Yields</dt>
<dd class="field-even"><p>tuples of (indent, Location, array indices, raw bytes, value)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.AtomicLocation.raw">
<span class="sig-name descname"><span class="pre">raw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">instance</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.NDInstance" title="stingray.schema_instance.NDInstance"><span class="pre">stingray.schema_instance.NDInstance</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#stingray.schema_instance.AtomicLocation.raw" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the bytes of this location.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>instance</strong> – The Non-Delimited Instance</p></li>
<li><p><strong>offset</strong> – The offset into the sequence</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The raw bytes from this location</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.AtomicLocation.value">
<span class="sig-name descname"><span class="pre">value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">instance</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.NDInstance" title="stingray.schema_instance.NDInstance"><span class="pre">stingray.schema_instance.NDInstance</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#stingray.schema_instance.AtomicLocation.value" title="Permalink to this definition">¶</a></dt>
<dd><p>For an atomic value, locate the underlying value. This may involve unpacking.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>instance</strong> – The Non-Delimited Instance</p></li>
<li><p><strong>offset</strong> – The offset into the sequence</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The Python object unpacked from this location</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stingray.schema_instance.ObjectLocation">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">stingray.schema_instance.</span></span><span class="sig-name descname"><span class="pre">ObjectLocation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">schema</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.Schema" title="stingray.schema_instance.Schema"><span class="pre">stingray.schema_instance.Schema</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">properties</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">'Location'</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stingray.schema_instance.ObjectLocation" title="Permalink to this definition">¶</a></dt>
<dd><p>The location of an object with a dictionary of named properties. A COBOL group-level item.</p>
<p>type(Schema) == ObjectSchema.</p>
<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.ObjectLocation.dump_iter">
<span class="sig-name descname"><span class="pre">dump_iter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nav</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.NDNav" title="stingray.schema_instance.NDNav"><span class="pre">stingray.schema_instance.NDNav</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">indent</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">collections.abc.Iterator</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="#stingray.schema_instance.Location" title="stingray.schema_instance.Location"><span class="pre">stingray.schema_instance.Location</span></a><span class="p"><span class="pre">,</span> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">typing.Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bytes</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">typing.Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#stingray.schema_instance.ObjectLocation.dump_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Dump this object location and all the properties within it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nav</strong> – The parent <a class="reference internal" href="#stingray.schema_instance.NDNav" title="stingray.schema_instance.NDNav"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDNav</span></code></a> instance with schema details.</p></li>
<li><p><strong>indent</strong> – The indentation level</p></li>
</ul>
</dd>
<dt class="field-even">Yields</dt>
<dd class="field-even"><p>tuples of (indent, Location, array indices, raw bytes, value)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.ObjectLocation.raw">
<span class="sig-name descname"><span class="pre">raw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">instance</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.NDInstance" title="stingray.schema_instance.NDInstance"><span class="pre">stingray.schema_instance.NDInstance</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#stingray.schema_instance.ObjectLocation.raw" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the bytes of this location.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>instance</strong> – The Non-Delimited Instance</p></li>
<li><p><strong>offset</strong> – The offset into the sequence</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>instance bytes (or characters if it’s a text instance.)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.ObjectLocation.value">
<span class="sig-name descname"><span class="pre">value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">instance</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.NDInstance" title="stingray.schema_instance.NDInstance"><span class="pre">stingray.schema_instance.NDInstance</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#stingray.schema_instance.ObjectLocation.value" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the value of this location.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>instance</strong> – The Non-Delimited Instance</p></li>
<li><p><strong>offset</strong> – The offset into the sequence</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The Python object unpacked from this location</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stingray.schema_instance.OneOfLocation">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">stingray.schema_instance.</span></span><span class="sig-name descname"><span class="pre">OneOfLocation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">schema</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.Schema" title="stingray.schema_instance.Schema"><span class="pre">stingray.schema_instance.Schema</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">alternatives</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#stingray.schema_instance.Location" title="stingray.schema_instance.Location"><span class="pre">stingray.schema_instance.Location</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stingray.schema_instance.OneOfLocation" title="Permalink to this definition">¶</a></dt>
<dd><p>The location of an object which has a list of REDEFINES alternatives.</p>
<p>type(Schema) == OneOfSchema.</p>
<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.OneOfLocation.dump_iter">
<span class="sig-name descname"><span class="pre">dump_iter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nav</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.NDNav" title="stingray.schema_instance.NDNav"><span class="pre">stingray.schema_instance.NDNav</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">indent</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">collections.abc.Iterator</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="#stingray.schema_instance.Location" title="stingray.schema_instance.Location"><span class="pre">stingray.schema_instance.Location</span></a><span class="p"><span class="pre">,</span> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">typing.Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bytes</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">typing.Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#stingray.schema_instance.OneOfLocation.dump_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Dump this object location and all the alternative definitions.
Since some of these may raise exceptions, displays may be incomplete.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nav</strong> – The parent <a class="reference internal" href="#stingray.schema_instance.NDNav" title="stingray.schema_instance.NDNav"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDNav</span></code></a> instance with schema details.</p></li>
<li><p><strong>indent</strong> – The indentation level</p></li>
</ul>
</dd>
<dt class="field-even">Yields</dt>
<dd class="field-even"><p>tuples of (indent, Location, array indices, raw bytes, value)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.OneOfLocation.raw">
<span class="sig-name descname"><span class="pre">raw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">instance</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.NDInstance" title="stingray.schema_instance.NDInstance"><span class="pre">stingray.schema_instance.NDInstance</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#stingray.schema_instance.OneOfLocation.raw" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the bytes of this location.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>instance</strong> – The Non-Delimited Instance</p></li>
<li><p><strong>offset</strong> – The offset into the sequence</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>instance bytes (or characters if it’s a text instance.)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.OneOfLocation.value">
<span class="sig-name descname"><span class="pre">value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">instance</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.NDInstance" title="stingray.schema_instance.NDInstance"><span class="pre">stingray.schema_instance.NDInstance</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#stingray.schema_instance.OneOfLocation.value" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the value of this location.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>instance</strong> – The Non-Delimited Instance</p></li>
<li><p><strong>offset</strong> – The offset into the sequence</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The Python object unpacked from this location</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stingray.schema_instance.RefToLocation">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">stingray.schema_instance.</span></span><span class="sig-name descname"><span class="pre">RefToLocation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">schema</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.Schema" title="stingray.schema_instance.Schema"><span class="pre">stingray.schema_instance.Schema</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">anchors</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="#stingray.schema_instance.Location" title="stingray.schema_instance.Location"><span class="pre">stingray.schema_instance.Location</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stingray.schema_instance.RefToLocation" title="Permalink to this definition">¶</a></dt>
<dd><p>Part of REDEFINES; this is the COBOL-visible name of a path into a <code class="docutils literal notranslate"><span class="pre">OneOfLocation</span></code> alternative.</p>
<p>type(Schema) == RefToSchema.</p>
<p>This could also be part of <code class="docutils literal notranslate"><span class="pre">OCCURS</span> <span class="pre">DEPENDING</span> <span class="pre">ON</span></code>.
If used like this, it would refer to the COBOL-visible name of an item with an array size.
The <code class="docutils literal notranslate"><span class="pre">OCCURS</span> <span class="pre">DEPENDING</span> <span class="pre">ON</span></code> doesn’t formalize this, however.</p>
<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.RefToLocation.dump_iter">
<span class="sig-name descname"><span class="pre">dump_iter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nav</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.NDNav" title="stingray.schema_instance.NDNav"><span class="pre">stingray.schema_instance.NDNav</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">indent</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">collections.abc.Iterator</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="#stingray.schema_instance.Location" title="stingray.schema_instance.Location"><span class="pre">stingray.schema_instance.Location</span></a><span class="p"><span class="pre">,</span> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">typing.Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bytes</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">typing.Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#stingray.schema_instance.RefToLocation.dump_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>These items are silenced – they were already displayed in an earlier OneOf.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stingray.schema_instance.RefToLocation.properties">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">properties</span></span><em class="property"><span class="pre">:</span> <span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="#stingray.schema_instance.Location" title="stingray.schema_instance.Location"><span class="pre">stingray.schema_instance.Location</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#stingray.schema_instance.RefToLocation.properties" title="Permalink to this definition">¶</a></dt>
<dd><p>Deference the anchor name and get the properties.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>properties of the referred-to name.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.RefToLocation.raw">
<span class="sig-name descname"><span class="pre">raw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">instance</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.NDInstance" title="stingray.schema_instance.NDInstance"><span class="pre">stingray.schema_instance.NDInstance</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#stingray.schema_instance.RefToLocation.raw" title="Permalink to this definition">¶</a></dt>
<dd><p>Dereference the anchor name and return the bytes of this location.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>instance</strong> – The Non-Delimited Instance</p></li>
<li><p><strong>offset</strong> – The offset into the sequence</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>instance bytes (or characters if it’s a text instance.)</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stingray.schema_instance.RefToLocation.referent">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">referent</span></span><em class="property"><span class="pre">:</span> <a class="reference internal" href="#stingray.schema_instance.Location" title="stingray.schema_instance.Location"><span class="pre">stingray.schema_instance.Location</span></a></em><a class="headerlink" href="#stingray.schema_instance.RefToLocation.referent" title="Permalink to this definition">¶</a></dt>
<dd><p>Deference the anchor name and get the properties.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The Location referred to.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.RefToLocation.value">
<span class="sig-name descname"><span class="pre">value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">instance</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.NDInstance" title="stingray.schema_instance.NDInstance"><span class="pre">stingray.schema_instance.NDInstance</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#stingray.schema_instance.RefToLocation.value" title="Permalink to this definition">¶</a></dt>
<dd><p>Dereference the anchor name and return the value of this location.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>instance</strong> – The Non-Delimited Instance</p></li>
<li><p><strong>offset</strong> – The offset into the sequence</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The Python object unpacked from this location</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stingray.schema_instance.LocationMaker">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">stingray.schema_instance.</span></span><span class="sig-name descname"><span class="pre">LocationMaker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unpacker</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.Unpacker" title="stingray.schema_instance.Unpacker"><span class="pre">stingray.schema_instance.Unpacker</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#stingray.schema_instance.NDInstance" title="stingray.schema_instance.NDInstance"><span class="pre">stingray.schema_instance.NDInstance</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">schema</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.Schema" title="stingray.schema_instance.Schema"><span class="pre">stingray.schema_instance.Schema</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stingray.schema_instance.LocationMaker" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates <a class="reference internal" href="#stingray.schema_instance.Location" title="stingray.schema_instance.Location"><code class="xref py py-class docutils literal notranslate"><span class="pre">Location</span></code></a> objects to find sub-instances in a non-delimited <code class="docutils literal notranslate"><span class="pre">NDInstance</span></code>.</p>
<p>A <a class="reference internal" href="#stingray.schema_instance.LocationMaker" title="stingray.schema_instance.LocationMaker"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocationMaker</span></code></a> walks through a <code class="docutils literal notranslate"><span class="pre">Schema</span></code> structure applied to a <code class="docutils literal notranslate"><span class="pre">NDInstance</span></code> to
emit <code class="docutils literal notranslate"><span class="pre">Location</span></code> objects. This is based on the current values in the <cite>NDInstance</cite>,
to support providing a properly-computed value for <code class="docutils literal notranslate"><span class="pre">OCCURS</span> <span class="pre">DEPENDING</span> <span class="pre">ON</span></code> arrays.</p>
<p>This is based on an <code class="xref py py-class docutils literal notranslate"><span class="pre">NDUnpacker</span></code> definition of the physical format of the file.
It’s only used for non-delimited files where the underlying <cite>NDInstance</cite> is <cite>Union[bytes, str]</cite>.</p>
<p>This creates <code class="docutils literal notranslate"><span class="pre">NDNav</span></code> isntances for navigation through Non-Delimited instances.</p>
<p>The algorithm is a post-order traversal of the subschema to build <cite>Location</cite> instances
that contain references to their children.</p>
<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.LocationMaker.from_instance">
<span class="sig-name descname"><span class="pre">from_instance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">instance</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.NDInstance" title="stingray.schema_instance.NDInstance"><span class="pre">stingray.schema_instance.NDInstance</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#stingray.schema_instance.Location" title="stingray.schema_instance.Location"><span class="pre">stingray.schema_instance.Location</span></a></span></span><a class="headerlink" href="#stingray.schema_instance.LocationMaker.from_instance" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds a <a class="reference internal" href="#stingray.schema_instance.Location" title="stingray.schema_instance.Location"><code class="xref py py-class docutils literal notranslate"><span class="pre">Location</span></code></a> from an non-delimited py:class:<cite>NDInstance</cite>.</p>
<p>This will handle <code class="docutils literal notranslate"><span class="pre">OCCURS</span> <span class="pre">DEPENDING</span> <span class="pre">ON</span></code>
references and dynamically-sized arrays.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>instance</strong> – The record instance.</p></li>
<li><p><strong>start</strong> – The initial offset, usually zero.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a <a class="reference internal" href="#stingray.schema_instance.Location" title="stingray.schema_instance.Location"><code class="xref py py-class docutils literal notranslate"><span class="pre">Location</span></code></a> describing this instance.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.LocationMaker.from_schema">
<span class="sig-name descname"><span class="pre">from_schema</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#stingray.schema_instance.Location" title="stingray.schema_instance.Location"><span class="pre">stingray.schema_instance.Location</span></a></span></span><a class="headerlink" href="#stingray.schema_instance.LocationMaker.from_schema" title="Permalink to this definition">¶</a></dt>
<dd><p>Attempt to build a <a class="reference internal" href="#stingray.schema_instance.Location" title="stingray.schema_instance.Location"><code class="xref py py-class docutils literal notranslate"><span class="pre">Location</span></code></a> from a schema.</p>
<p>This will raise an exception if there is an <code class="docutils literal notranslate"><span class="pre">OCCURS</span> <span class="pre">DEPENDING</span> <span class="pre">ON</span></code>.
For these kinds of DDE’s, an instance must be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>start</strong> – The initial offset, usually zero.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a <a class="reference internal" href="#stingray.schema_instance.Location" title="stingray.schema_instance.Location"><code class="xref py py-class docutils literal notranslate"><span class="pre">Location</span></code></a> describing any instance of this schema.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.LocationMaker.ndnav">
<span class="sig-name descname"><span class="pre">ndnav</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">instance</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.NDInstance" title="stingray.schema_instance.NDInstance"><span class="pre">stingray.schema_instance.NDInstance</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#stingray.schema_instance.NDNav" title="stingray.schema_instance.NDNav"><span class="pre">stingray.schema_instance.NDNav</span></a></span></span><a class="headerlink" href="#stingray.schema_instance.LocationMaker.ndnav" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <a class="reference internal" href="#stingray.schema_instance.NDNav" title="stingray.schema_instance.NDNav"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDNav</span></code></a> navigation helper
for an Instance using an Unpacker and Schema.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>instance</strong> – The non-delimited instance to navigate into.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>an <a class="reference internal" href="#stingray.schema_instance.NDNav" title="stingray.schema_instance.NDNav"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDNav</span></code></a> primed with location information unique to this instance.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.LocationMaker.size">
<span class="sig-name descname"><span class="pre">size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">schema</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.Schema" title="stingray.schema_instance.Schema"><span class="pre">stingray.schema_instance.Schema</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#stingray.schema_instance.LocationMaker.size" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the overall size of a given schema.</p>
<p>The work is delegated to the <a class="reference internal" href="#stingray.schema_instance.Unpacker" title="stingray.schema_instance.Unpacker"><code class="xref py py-class docutils literal notranslate"><span class="pre">Unpacker</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>schema</strong> – The schema to size.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The size</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stingray.schema_instance.LocationMaker.walk">
<span class="sig-name descname"><span class="pre">walk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">schema</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#stingray.schema_instance.Schema" title="stingray.schema_instance.Schema"><span class="pre">stingray.schema_instance.Schema</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#stingray.schema_instance.Location" title="stingray.schema_instance.Location"><span class="pre">stingray.schema_instance.Location</span></a></span></span><a class="headerlink" href="#stingray.schema_instance.LocationMaker.walk" title="Permalink to this definition">¶</a></dt>
<dd><p>Recursive descent into a Schema, creating a <a class="reference internal" href="#stingray.schema_instance.Location" title="stingray.schema_instance.Location"><code class="xref py py-class docutils literal notranslate"><span class="pre">Location</span></code></a>.
This is generally used via the <a class="reference internal" href="#stingray.schema_instance.LocationMaker.from_instance" title="stingray.schema_instance.LocationMaker.from_instance"><code class="xref py py-meth docutils literal notranslate"><span class="pre">from_instance()</span></code></a> method.
It is not invoked directly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>schema</strong> – A schema describing a non-delimited <code class="xref py py-class docutils literal notranslate"><span class="pre">NDInstance`</span></code>.</p></li>
<li><p><strong>start</strong> – A starting offset into the <a class="reference internal" href="#stingray.schema_instance.NDInstance" title="stingray.schema_instance.NDInstance"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDInstance</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a <a class="reference internal" href="#stingray.schema_instance.Location" title="stingray.schema_instance.Location"><code class="xref py py-class docutils literal notranslate"><span class="pre">Location</span></code></a> with this item’s location and the location
of all children or array items.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="exceptions">
<h2>Exceptions<a class="headerlink" href="#exceptions" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="stingray.schema_instance.DesignError">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">stingray.schema_instance.</span></span><span class="sig-name descname"><span class="pre">DesignError</span></span><a class="headerlink" href="#stingray.schema_instance.DesignError" title="Permalink to this definition">¶</a></dt>
<dd><p>This is a catastrophic design problem.
A common root cause is a named REGEX capture clause that’s not properly
handled by a class, method, or function.</p>
</dd></dl>

</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/Stingray_belon1553_small.png" alt="Logo"/>
            </a></p>
<h1 class="logo"><a href="../../index.html">Stingray-Reader</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developer.html">Using <strong>Stingray Reader</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../design.html">Design Considerations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../demo/index.html">Demo Applications</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">stingray API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../history.html">History</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../testing.html">Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../license.html">Commercial Use</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">stingray API Reference</a><ul>
      <li>Previous: <a href="stingray.estruct.html" title="previous chapter">stingray.estruct</a></li>
      <li>Next: <a href="stingray.cobol_parser.html" title="next chapter">stingray.cobol_parser</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021, S.Lott.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.2.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../_sources/apidoc/modules/stingray.schema_instance.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>